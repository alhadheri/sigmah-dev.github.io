<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">

<!-- Mirrored from wiki.sigmah.org/doku.php?id=contributorguide:preparebuildenvironment&do=edit by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 05 Jul 2018 16:55:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <title>✎ contributorguide:preparebuildenvironment [Sigmah wiki]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="noindex,nofollow"/>
<link rel="search" type="application/opensearchdescription+xml" href="http://wiki.sigmah.org/lib/exe/opensearch.php" title="Sigmah wiki"/>
<link rel="start" href="http://wiki.sigmah.org/"/>
<link rel="contents" href="http://wiki.sigmah.org/doku.php?id=contributorguide:preparebuildenvironment&amp;do=index" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="http://wiki.sigmah.org/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="http://wiki.sigmah.org/feed.php?mode=list&amp;ns=contributorguide"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="http://wiki.sigmah.org/doku.php?do=export_xhtml&amp;id=contributorguide:preparebuildenvironment"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="http://wiki.sigmah.org/doku.php?do=export_raw&amp;id=contributorguide:preparebuildenvironment"/>
<link rel="stylesheet" type="text/css" href="http://wiki.sigmah.org/lib/exe/css.php?t=dokuwiki&amp;tseed=74cd2fc0434d10331b9bc01ea3827dea"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='contributorguide';var JSINFO = {"id":"contributorguide:preparebuildenvironment","namespace":"contributorguide"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://wiki.sigmah.org/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="http://wiki.sigmah.org/lib/exe/js.php?t=dokuwiki&amp;tseed=74cd2fc0434d10331b9bc01ea3827dea"></script>
<!--<![endif]-->
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="http://wiki.sigmah.org/lib/tpl/dokuwiki/images/favicon.ico" />
<link rel="apple-touch-icon" href="http://wiki.sigmah.org/lib/tpl/dokuwiki/images/apple-touch-icon.png" />
    </head>

<body>
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_edit tpl_dokuwiki     hasSidebar">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="http://wiki.sigmah.org/doku.php?id=start"  accesskey="h" title="[H]"><img src="http://wiki.sigmah.org/lib/tpl/dokuwiki/images/logo.png" width="64" height="64" alt="" /> <span>Sigmah wiki</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="http://wiki.sigmah.org/doku.php?id=contributorguide:preparebuildenvironment&amp;do=register"  class="action register" rel="nofollow" title="Register">Register</a></li><li><a href="http://wiki.sigmah.org/doku.php?id=contributorguide:preparebuildenvironment&amp;do=login&amp;sectok="  class="action login" rel="nofollow" title="Log In">Log In</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="http://wiki.sigmah.org/doku.php?id=start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" placeholder="Search" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><button type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="http://wiki.sigmah.org/doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="contributorguide:preparebuildenvironment" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="">Show page</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent Changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Log In</option><option value="register">Register</option></optgroup></select><button type="submit">&gt;</button></div></form>            </div>
            <ul>
                <li><a href="http://wiki.sigmah.org/doku.php?id=contributorguide:preparebuildenvironment&amp;do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent Changes [R]">Recent Changes</a></li><li><a href="http://wiki.sigmah.org/doku.php?id=contributorguide:preparebuildenvironment&amp;do=media&amp;ns=contributorguide"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a href="http://wiki.sigmah.org/doku.php?id=contributorguide:preparebuildenvironment&amp;do=index"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                                        <div class="trace"><span class="bchead">Trace:</span> <span class="bcsep">•</span> <bdi><a href="http://wiki.sigmah.org/doku.php?id=model:user_unit"  class="breadcrumbs" title="model:user_unit">user_unit</a></bdi> <span class="bcsep">•</span> <bdi><a href="http://wiki.sigmah.org/doku.php?id=model:user_unit_profiles"  class="breadcrumbs" title="model:user_unit_profiles">user_unit_profiles</a></bdi> <span class="bcsep">•</span> <bdi><a href="http://wiki.sigmah.org/doku.php?id=model:value"  class="breadcrumbs" title="model:value">value</a></bdi> <span class="bcsep">•</span> <bdi><a href="http://wiki.sigmah.org/doku.php?id=ssoc:ideas4gsoc2017"  class="breadcrumbs" title="ssoc:ideas4gsoc2017">ideas4gsoc2017</a></bdi> <span class="bcsep">•</span> <bdi><a href="http://wiki.sigmah.org/doku.php?id=ssoc:ideas4gsoc2016"  class="breadcrumbs" title="ssoc:ideas4gsoc2016">ideas4gsoc2016</a></bdi> <span class="bcsep">•</span> <bdi><a href="http://wiki.sigmah.org/doku.php?id=ssoc:ideas4soc2015"  class="breadcrumbs" title="ssoc:ideas4soc2015">ideas4soc2015</a></bdi> <span class="bcsep">•</span> <bdi><a href="http://wiki.sigmah.org/doku.php?id=ssoc:ideas4gsoc2014"  class="breadcrumbs" title="ssoc:ideas4gsoc2014">ideas4gsoc2014</a></bdi> <span class="bcsep">•</span> <bdi><a href="http://wiki.sigmah.org/doku.php?id=ssoc:ideas4gsoc2013"  class="breadcrumbs" title="ssoc:ideas4gsoc2013">ideas4gsoc2013</a></bdi> <span class="bcsep">•</span> <bdi><a href="http://wiki.sigmah.org/doku.php?id=ssoc:ideas4gsoc2012"  class="breadcrumbs" title="ssoc:ideas4gsoc2012">ideas4gsoc2012</a></bdi> <span class="bcsep">•</span> <span class="curid"><bdi><a href="http://wiki.sigmah.org/doku.php?id=ssoc:sigmahsummerofcode"  class="breadcrumbs" title="ssoc:sigmahsummerofcode">sigmahsummerofcode</a></bdi></span></div>
                    </div>
    


    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                
                <div class="pageId"><span>contributorguide:preparebuildenvironment</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    
<p>
This page is read only. You can view the source, but not change it. Ask your administrator if you think this is wrong.
</p>
    <div class="editBox" role="application">

    <div class="toolbar group">
        <div id="draft__status"></div>
        <div id="tool__bar"></div>
    </div>
    <form id="dw__editform" method="post" action="#" accept-charset="utf-8"><div class="no">
<input type="hidden" name="sectok" value="" /><input type="hidden" name="id" value="contributorguide:preparebuildenvironment" /><input type="hidden" name="rev" value="0" /><input type="hidden" name="date" value="1496916716" /><input type="hidden" name="prefix" value="." /><input type="hidden" name="suffix" value="" /><input type="hidden" name="changecheck" value="124610c3441be80bc30a96bfefe4cabe" /><input type="hidden" name="target" value="section" /><textarea name="wikitext" id="wiki__text" dir="auto" class="edit" cols="80" rows="10" tabindex="1" readonly="readonly">
# Step 0: prerequisites

## Environment and tooling

If you want to start developing on sigmah, you need to set your environment up. If you develop Java application on a regular basis, you may already fulfill all the requirements. Any Sigmah developer needs the following:
  * JDK 1.6\*
  * Postgresql 9
  * Maven 3
  * Git 2.7

Before continuing, make sure everything is properly installed.

//\*JDK 1.6// : JDK8 is actually better for use with Sigmah since it removes some headaches related to memory management. However, the syntax is limited to Java 6 in the client and shared packages due to the outdated version of GWT required by GXT. So any JDK from JDK6 will do the job, but new syntax added in JDK7 and JDK8 should not be used in the client and shared packages.

## Creating a database to store Sigmah data
### Windows

Now you should have a PostgreSQL server and pgAdmin III installed. To be able to test your development with Sigmah, you will need to create now a test database.

  - Open pgAdmin III.

{{:contributorguide:22_pgadminiii.png?nolink|}}

  - Connect to your server, and add a new database.

{{:contributorguide:23_pgadminiii.png?nolink|}}

  - Name it “sigmah”, keep “postgres” as the owner, and UTF8 encoding.

Install the [[https://www.postgresql.org/docs/current/static/pgtrgm.html|pg_trgm postgresql extension]] (required so Sigmah can full-text search). Connect to the Sigmah database and run:

```sql
CREATE EXTENSION IF NOT EXISTS pg_trgm;
```

### Linux

Connect as the postgres user, it's required for anything about your local PosgreSQL instance.

```bash
sudo su postgres
```

We will create a PostgreSQL user, let's call him &quot;sigmah&quot; and give it the right to create a database

```bash
createuser sigmah --createdb --pwprompt
```

You will be prompted a password, let's enter 

  hamsig

That's all we need to do as postgres, log out from postgres user and continue as your everyday user.

Now the user is created, let's create him a database (with UTF-8 encoding)

```bash
createdb -U sigmah sigmah -E utf-8
```

Now, log out from postgres user.

Let's check everything is OK by connecting:

```bash
psql sigmah -U sigmah
```

Enter the hamsig password. If you connected successfully, everything is OK.

Install the [[https://www.postgresql.org/docs/current/static/pgtrgm.html|pg_trgm postgresql extension]] (required so Sigmah can full-text search):

```bash
psql --username postgres sigmah --command &quot;CREATE EXTENSION IF NOT EXISTS pg_trgm;&quot;
```


## Creating a folder to store Sigmah files

Create any folder in your filesystem to store Sigmah application files: organisation logo, files attachment and archives workdir.
In the rest of this procedure, we'll consider that this folder will be a Windows folder ''C:\Sigmah\files\sigmah_lightdev''.

# Step 1: fork the official Github repository

The main Sigmah repository is hosted at github. To contribute, you should fork the project first.

Go to https://github.com/sigmah-dev/sigmah and click &quot;Fork&quot;. Github will create your own repository, with its own URL like: https://github.com/**your-github-account**/sigmah.git

# Step 2: get a local copy of the source

You can now get the source on your local machine, by using command-line:

  git clone https://github.com/your-github-account/sigmah.git



**[Optional] If you are under Windows**, type also now the following config command to avoid end-of-line issues while committing:
  git config --global core.autocrlf true

# Step 3: your first build

Our build process is based on maven. Since you are a developer, we made the things simple for you. There is a maven profile named ''sigmah-dev''. It will reduce compilation time among others simplifications to ease your daily workflow.

Now, remember that maven must be aware of your configuration so you must create a ''settings.xml'' file in your Maven user directory ''.m2'' subfolder (ie: ''C:\Users\MyUserName\\.m2\'' on Windows) with the following lines, which will at build time automatically override the values of the matching properties of the central Sigmah Maven ''pom.xml'' file:
    
&lt;code xml settings.xml&gt;
&lt;settings&gt; 
  &lt;profiles&gt;
        &lt;profile&gt;
            &lt;id&gt;sigmah-dev&lt;/id&gt;
            &lt;properties&gt;
                &lt;sigmah.database.url&gt;jdbc:postgresql://localhost:5432/sigmah&lt;/sigmah.database.url&gt;
                &lt;sigmah.database.user&gt;sigmah&lt;/sigmah.database.user&gt;
                &lt;sigmah.database.password&gt;hamsig&lt;/sigmah.database.password&gt;
                &lt;files.repository.name&gt;C:\\Sigmah\\files\\sigmah_dev&lt;/files.repository.name&gt;
                &lt;archives.repository.name&gt;C:\\Sigmah\\files\\sigmah_dev\\archives&lt;/archives.repository.name&gt;
            &lt;/properties&gt;
        &lt;/profile&gt;
   &lt;/profiles&gt;
&lt;/settings&gt; 
&lt;/code&gt;

You can build the application using the following, traditional maven command.

  mvn install -Psigmah-dev

# Step 4: create the database schema

We rely on the Flyway database migration framework to keep everyone's postgresql instance up-to-date with every change made on the schema. Flyway can tell you the precise state or your database.

  mvn flyway:info -Psigmah-dev

Here is an example output.

  [INFO] Scanning for projects...
  [INFO]
  [INFO] ------------------------------------------------------------------------
  [INFO] Building Sigmah 2.2-SNAPSHOT
  [INFO] ------------------------------------------------------------------------
  [INFO]
  [INFO] --- flyway-maven-plugin:3.2.1:info (default-cli) @ sigmah ---
  [INFO] Flyway 3.2.1 by Boxfuse
  [INFO] Database: jdbc:postgresql://localhost:5432/sigmah (PostgreSQL 9.3)
  [INFO]
  +---------+----------------------------------------+---------------------+---------+
  | Version | Description                            | Installed on        | State   |
  +---------+----------------------------------------+---------------------+---------+
  | 1       | sigmah minimum data kit for sigmah 2.0 | 2016-09-01 10:09:57 | Success |
  | 2       | computation field                      | 2016-09-01 10:09:59 | Success |
  | 3       | project team                           | 2016-09-01 10:09:59 | Success |
  | 4       | secondary org units                    | 2016-09-01 10:09:59 | Success |
  | 5       | project model framework                | 2016-09-01 10:09:59 | Success |
  | 6       | contacts model                         | 2016-09-01 10:09:59 | Success |
  | 7       | contacts                               | 2016-09-01 10:09:59 | Success |
  | 8       | contact list element                   | 2016-09-01 10:09:59 | Success |
  | 9       | dedupe contacts                        |                     | Pending |
  | 10      | group iterations                       |                     | Pending |
  | 11      | iterations history token               |                     | Pending |
  | 12      | global contact export                  |                     | Pending |
  +---------+----------------------------------------+---------------------+---------+
  
  [INFO] ------------------------------------------------------------------------
  [INFO] BUILD SUCCESS
  [INFO] ------------------------------------------------------------------------
  [INFO] Total time: 1.927 s
  [INFO] Finished at: 2016-09-01T11:17:05+02:00
  [INFO] Final Memory: 14M/205M
  [INFO] ------------------------------------------------------------------------

We can see that there is a **pending** migration. Let's run it by running 

  mvn flyway:migrate -Psigmah-dev

When you upgrade sigmah, always check ''flyway:info'' to see if there is any pending migration (and run ''flyway:migrate'' if necessary). If you don't do so, you may encounter random bugs due to the fact that the database schema is not quite like your sigmah version expect it.</textarea>
<div id="wiki__editbar" class="editBar">
<div id="size__ctl">
</div>
</div>
</div></form>
</div>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>contributorguide/preparebuildenvironment.txt</bdi> · Last modified: 2017/06/08 12:11 by <bdi>osarrat</bdi></div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="http://wiki.sigmah.org/doku.php?id=contributorguide:preparebuildenvironment&amp;do="  class="action show" accesskey="v" rel="nofollow" title="Show page [V]"><span>Show page</span></a></li><li><a href="http://wiki.sigmah.org/doku.php?id=contributorguide:preparebuildenvironment&amp;do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="http://wiki.sigmah.org/doku.php?id=contributorguide:preparebuildenvironment&amp;do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <div class="license">Except where otherwise noted, content on this wiki is licensed under the following license: <bdi><a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="license" class="urlextern">CC Attribution-Share Alike 4.0 International</a></bdi></div>
    <div class="buttons">
        <a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="license"><img src="http://wiki.sigmah.org/lib/images/license/button/cc-by-sa.png" alt="CC Attribution-Share Alike 4.0 International" /></a>        <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="http://wiki.sigmah.org/lib/tpl/dokuwiki/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://php.net/" title="Powered by PHP" ><img
            src="http://wiki.sigmah.org/lib/tpl/dokuwiki/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="http://wiki.sigmah.org/lib/tpl/dokuwiki/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="http://wiki.sigmah.org/lib/tpl/dokuwiki/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="http://wiki.sigmah.org/lib/tpl/dokuwiki/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="http://wiki.sigmah.org/lib/exe/indexer.php?id=contributorguide%3Apreparebuildenvironment&amp;1530808945" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div></body>

<!-- Mirrored from wiki.sigmah.org/doku.php?id=contributorguide:preparebuildenvironment&do=edit by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 05 Jul 2018 16:55:41 GMT -->
</html>
