<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>

<!-- Mirrored from www.sigmah.org/issues/view.php?id=438&history=1 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 25 Jul 2018 16:11:07 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
	<link rel="stylesheet" type="text/css" href="css/default.html" />
	<script type="text/javascript"><!--
		if(document.layers) {document.write("<style>td{padding:0px;}<\/style>")}
	// --></script>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Cache-Control" content="no-cache" />
	<meta http-equiv="Pragma-directive" content="no-cache" />
	<meta http-equiv="Cache-Directive" content="no-cache" />
	<meta http-equiv="Expires" content="Wed, 25 Jul 2018 15:39:37 GMT" />
	<link rel="shortcut icon" href="images/favicon.html" type="image/x-icon" />
	<link rel="search" type="application/opensearchdescription+xml" title="MantisBT: Text Search" href="browser_search_plugin84ae.html?type=text" />	<link rel="search" type="application/opensearchdescription+xml" title="MantisBT: Issue Id" href="browser_search_pluginb70d.html?type=id" />	<title>0000438: Own password modification by user - Sigmah Issue Tracker</title>
<script type="text/javascript" src="javascript/min/common.html"></script>
<script type="text/javascript">var loading_lang = "Loading...";</script><script type="text/javascript" src="javascript/min/ajax.js"></script>
<link rel="stylesheet" type="text/css" href="plugin_filea93c.css?file=Source/style.css"/></head>
<body>
<div align="left"><a href="my_view_page.html"><img border="0" alt="Sigmah Issue Tracker" src="images/sigmah-logo-Mantis.html" /></a></div><table class="hide"><tr><td class="login-info-left">Anonymous | <a href="login_pagedfaa.html?return=%2Fissues%2Fview.php%3Fid%3D438%26history%3D1">Login</a> | <a href="signup_page.html">Signup for a new account</a></td><td class="login-info-middle"><span class="italic">2018-07-25 17:39 CEST</span></td><td class="login-info-right"><form method="post" name="form_set_project" action="http://www.sigmah.org/issues/set_project.php">Project: <select name="project_id" class="small" onchange="document.forms.form_set_project.submit();"><option value="0" selected="selected" >All Projects</option>
<option value="1">sigmah</option>
<option value="4">Sigmah Central</option>
</select> <input type="submit" class="button-small" value="Switch" /></form><a href="200_rss_Sigmah_Issue_Tracker_-_Issuesd41d.xml?"><img src="images/rss.html" alt="RSS" style="border-style: none; margin: 5px; vertical-align: middle;" /></a></td></tr></table><table class="width100" cellspacing="0"><tr><td class="menu"><a href="my_view_page.html">My View</a> | <a href="view_all_bug_page.html">View Issues</a> | <a href="changelog_page.html">Change Log</a> | <a href="roadmap_page.html">Roadmap</a> | <a href="plugina0e2.html?page=Source/index">Repositories</a> | <a href="account_page.html">My Account</a></td><td class="menu right nowrap"><form method="post" action="http://www.sigmah.org/issues/jump_to_bug.php"><input type="text" name="bug_id" size="10" class="small" value="Issue #" onfocus="if (this.value == 'Issue #') this.value = ''" onblur="if (this.value == '') this.value = 'Issue #'" />&#160;<input type="submit" class="button-small" value="Jump" />&#160;</form></td></tr></table><br /><table class="width100" cellspacing="1"><tr><td class="form-title" colspan="3">View Issue Details&#160;<span class="small"><span class="bracket-link">[&#160;<a href="#bugnotes">Jump to Notes</a>&#160;]</span> <span class="bracket-link">[&#160;<a href="#changesets">Related Changesets</a>&#160;]</span> </span></td><td class="center"><span class="small"></span></td><td class="right" colspan="2"><span class="small"><span class="bracket-link">[&#160;<a href="view2b9d.php?id=438&amp;history=1#history">Issue History</a>&#160;]</span> </span><span class="small"><span class="bracket-link">[&#160;<a href="print_bug_page5e8e.php?bug_id=438">Print</a>&#160;]</span> </span></td></tr><tr><td class="category" width="15%">ID</td><td class="category" width="20%">Project</td><td class="category" width="15%">Category</td><td class="category" width="15%">View Status</td><td class="category" width="15%">Date Submitted</td><td class="category" width="20%">Last Update</td></tr><tr class="row-1"><td>0000438</td><td>sigmah</td><td>Administration</td><td>public</td><td>2012-02-02 13:00</td><td>2015-04-03 17:17</td></tr><tr class="spacer"><td colspan="6"></td></tr><tr class="row-2"><td class="category">Reporter</td><td>osarrat</td><td colspan="4">&#160;</td></tr><tr class="row-1"><td class="category">Assigned To</td><td>renatoaf</td><td colspan="4">&#160;</td></tr><tr class="row-2"><td class="category">Priority</td><td>normal</td><td class="category">Severity</td><td>feature</td><td class="category">Reproducibility</td><td>N/A</td></tr><tr class="row-1"><td class="category">Status</td><td bgcolor="#c9ccc4">closed</td><td class="category">Resolution</td><td>fixed</td><td colspan="2">&#160;</td></tr><tr class="row-2"><td class="category">Platform</td><td></td><td class="category">OS</td><td></td><td class="category">OS Version</td><td></td></tr><tr class="row-1"><td class="category">Product Version</td><td>1.1</td><td colspan="4">&#160;</td></tr><tr class="row-2"><td class="category">Target Version</td><td>2.0</td><td class="category">Fixed in Version</td><td>2.0</td><td colspan="2">&#160;</td></tr><tr class="spacer"><td colspan="6"></td></tr><tr class="row-1"><td class="category">Summary</td><td colspan="5">0000438: Own password modification by user</td></tr><tr class="row-2"><td class="category">Description</td><td colspan="5">The users have no mean to change their password by themselves.<br />
A feature should be develop to allow this. This feature must be optionnal (using a global privilege for example) since some organizations may prefer to let only the administrator modifiy the passwords.<br />
<br />
The admin will be able to define in the Administration&gt;Settings screen a period for automatic renewal of the password. This period can be &quot;never&quot; if no automatic renewal is set up. (this feature is feature <a href="view6017.html?id=517" title="[assigned] Automatic user password reset">0000517</a>)<br />
<br />
If a user has this feature enabled with his user profile, he will be prompted to change his password by himself each time his password has been automatically set or reset (at the creation of his user account, or when his password has expired)</td></tr><tr class="row-1"><td class="category">Tags</td><td colspan="5"><a href='tag_view_page8369.php?tag_id=11' title=''>Enhanced user session and rights</a></td></tr><tr class="spacer"><td colspan="6"></td></tr><tr class="row-2"><td class="category">User Report URL</td><td colspan="5"><a href="http://www.sigmah.org/fr/node/551">http://www.sigmah.org/fr/node/551</a> [<a href="http://www.sigmah.org/fr/node/551" target="_blank">^</a>]</td></tr><tr class="row-1"><td class="category">OS</td><td colspan="5">NA</td></tr><tr class="row-2"><td class="category">Other OS</td><td colspan="5"></td></tr><tr class="row-1"><td class="category">Browser</td><td colspan="5">NA</td></tr><tr class="row-2"><td class="category">Other browser</td><td colspan="5"></td></tr><tr class="row-1"><td class="category">ScreenURL</td><td colspan="5"></td></tr><tr class="row-2"><td class="category">(ActivityInfo) Noticed in revision</td><td colspan="5"></td></tr><tr class="spacer"><td colspan="6"></td></tr><tr class="row-1"><td class="category"><a name="attachments" id="attachments" />Attached Files</td><td colspan="5"><a href="file_download74d8.php?file_id=173&amp;type=bug"><img src="images/fileicons/png.gif" alt="png file icon" width="16" height="16" border="0" /></a>&#160;<a href="file_download74d8.php?file_id=173&amp;type=bug">01.permission.png</a> [<a href="file_download74d8.php?file_id=173&amp;type=bug" target="_blank">^</a>] (143,736 bytes) <span class="italic">2014-05-27 05:40</span>
<br /><a href="file_download74d8.php?file_id=173&amp;type=bug"><img alt="" style="border: 0; max-height:250px;" src="01.permissionef6c.png?file_id=173&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20180725b22daff52352d43e62b30df1b14f643d3742a3b5" /></a><br />
<br /><a href="file_download0dcd.php?file_id=174&amp;type=bug"><img src="images/fileicons/png.gif" alt="png file icon" width="16" height="16" border="0" /></a>&#160;<a href="file_download0dcd.php?file_id=174&amp;type=bug">02.change_password_option.png</a> [<a href="file_download0dcd.php?file_id=174&amp;type=bug" target="_blank">^</a>] (89,624 bytes) <span class="italic">2014-05-27 05:40</span>
<br /><a href="file_download0dcd.php?file_id=174&amp;type=bug"><img alt="" style="border: 0; max-height:250px;" src="02.change_password_option0324.png?file_id=174&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20180725f8cde5f990a3e4c84eeee74c8618b0226baece99" /></a><br />
<br /><a href="file_download2a4d.php?file_id=175&amp;type=bug"><img src="images/fileicons/png.gif" alt="png file icon" width="16" height="16" border="0" /></a>&#160;<a href="file_download2a4d.php?file_id=175&amp;type=bug">03.change_password_prompt.png</a> [<a href="file_download2a4d.php?file_id=175&amp;type=bug" target="_blank">^</a>] (96,441 bytes) <span class="italic">2014-05-27 05:40</span>
<br /><a href="file_download2a4d.php?file_id=175&amp;type=bug"><img alt="" style="border: 0; max-height:250px;" src="03.change_password_promptdb68.png?file_id=175&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=2018072553ba6ddec9de4d55500ecde8322a20df572be183" /></a><br />
<br /><a href="file_download39f4.php?file_id=176&amp;type=bug"><img src="images/fileicons/png.gif" alt="png file icon" width="16" height="16" border="0" /></a>&#160;<a href="file_download39f4.php?file_id=176&amp;type=bug">04.expiration_policy_1.png</a> [<a href="file_download39f4.php?file_id=176&amp;type=bug" target="_blank">^</a>] (106,968 bytes) <span class="italic">2014-05-27 05:40</span>
<br /><a href="file_download39f4.php?file_id=176&amp;type=bug"><img alt="" style="border: 0; max-height:250px;" src="04.expiration_policy_10004.png?file_id=176&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20180725da8eded94d17b3d853a0a3273bda3392a1b5ed35" /></a><br />
<br /><a href="file_download51a1.php?file_id=177&amp;type=bug"><img src="images/fileicons/png.gif" alt="png file icon" width="16" height="16" border="0" /></a>&#160;<a href="file_download51a1.php?file_id=177&amp;type=bug">05.expiration_policy_2.png</a> [<a href="file_download51a1.php?file_id=177&amp;type=bug" target="_blank">^</a>] (119,297 bytes) <span class="italic">2014-05-27 05:41</span>
<br /><a href="file_download51a1.php?file_id=177&amp;type=bug"><img alt="" style="border: 0; max-height:250px;" src="05.expiration_policy_2febe.png?file_id=177&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=201807255fd13f1a5bf8cf460937c32f3f7667cbebc5ab58" /></a><br />
<br /><a href="file_downloadef6b.php?file_id=178&amp;type=bug"><img src="images/fileicons/text.html" alt="txt file icon" width="16" height="16" border="0" /></a>&#160;<a href="file_downloadef6b.php?file_id=178&amp;type=bug">438_patch.txt</a> [<a href="file_downloadef6b.php?file_id=178&amp;type=bug" target="_blank">^</a>] (62,224 bytes) <span class="italic">2014-05-27 05:43</span><script type="text/javascript" language="JavaScript">
<!--
function swap_content( span ) {
displayType = ( document.getElementById( span ).style.display == 'none' ) ? '' : 'none';
document.getElementById( span ).style.display = displayType;
}

 -->
 </script> <span id="hideSection_178">[<a class="small" href='#' id='attmlink_178' onclick='swap_content("hideSection_178");swap_content("showSection_178");return false;'>Show Content</a>]</span> <span style='display:none' id="showSection_178">[<a class="small" href='#' id='attmlink_178' onclick='swap_content("hideSection_178");swap_content("showSection_178");return false;'>Hide Content</a>]<pre>### Eclipse Workspace Patch 1.0
#P Sigmah
Index: src/main/java/org/sigmah/client/page/admin/management/AdminExportManagementPresenter.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminExportManagementPresenter.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminExportManagementPresenter.java	(working copy)
@@ -1,7 +1,5 @@
 package org.sigmah.client.page.admin.management;
 
-import java.util.Map;
-
 import org.sigmah.client.cache.UserLocalCache;
 import org.sigmah.client.dispatch.Dispatcher;
 import org.sigmah.client.i18n.I18N;
Index: src/main/java/org/sigmah/client/SigmahInjector.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/SigmahInjector.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/SigmahInjector.java	(working copy)
@@ -18,6 +18,7 @@
 import org.sigmah.client.page.admin.management.AdminCoreManagementPresenter;
 import org.sigmah.client.page.admin.management.AdminExportManagementPresenter;
 import org.sigmah.client.page.admin.management.AdminManagementPresenter;
+import org.sigmah.client.page.admin.management.AdminPasswordExpirationPolicyManagementPresenter;
 import org.sigmah.client.page.admin.model.common.AdminOneModelPresenter;
 import org.sigmah.client.page.charts.ChartPagePresenter;
 import org.sigmah.client.page.charts.SigmahChartLoader;
@@ -103,6 +104,7 @@
     AdminCoreManagementPresenter getAdminCoreManagementPresenter();
     AdminBackupManagementPresenter getAdminBackupManagementPresenter();
     AdminExportManagementPresenter getAdminExportManagementPresenter();
+    AdminPasswordExpirationPolicyManagementPresenter getAdminPasswordExpirationPolicyManagementPresenter();
     
     // Pages from ActivityInfo
     DataEntryLoader registerDataEntryLoader();
Index: src/main/java/org/sigmah/client/page/admin/management/AdminManagementPresenter.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminManagementPresenter.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminManagementPresenter.java	(working copy)
@@ -6,13 +6,8 @@
 import org.sigmah.client.page.admin.AdminPageState;
 import org.sigmah.client.page.admin.AdminSubPresenter;
 
-import com.extjs.gxt.ui.client.Style.LayoutRegion;
-import com.extjs.gxt.ui.client.util.Margins;
 import com.extjs.gxt.ui.client.widget.Component;
 import com.extjs.gxt.ui.client.widget.ContentPanel;
-import com.extjs.gxt.ui.client.widget.LayoutContainer;
-import com.extjs.gxt.ui.client.widget.layout.HBoxLayout;
-import com.extjs.gxt.ui.client.widget.layout.HBoxLayoutData;
 import com.google.inject.Inject;
 
 /**
@@ -52,20 +47,24 @@
         subPresenters = new AdminManagementSubPresenter[] {
                                                            injector.getAdminCoreManagementPresenter(),
                                                            injector.getAdminBackupManagementPresenter(),
-                                                           injector.getAdminExportManagementPresenter()};        
+                                                           injector.getAdminExportManagementPresenter(),
+                                                           injector.getAdminPasswordExpirationPolicyManagementPresenter()
+                                                          };        
         
         subPresenters[0].getContentPanel().setWidth(&quot;45%&quot;);
         subPresenters[1].getContentPanel().setWidth(&quot;55%&quot;);
-        subPresenters[2].getContentPanel().setWidth(&quot;100%&quot;);
+        subPresenters[2].getContentPanel().setWidth(&quot;45%&quot;);
+        subPresenters[3].getContentPanel().setWidth(&quot;55%&quot;);
 
         subPresenters[0].getContentPanel().setHeight(250);
         subPresenters[1].getContentPanel().setHeight(250);
         subPresenters[2].getContentPanel().setHeight(5000);
+        subPresenters[3].getContentPanel().setHeight(5000);
+        
         view.addPanelToMainContainer(subPresenters[0].getContentPanel());
         view.addPanelToMainContainer(subPresenters[1].getContentPanel());
         view.addPanelToSecondaryContainer(subPresenters[2].getContentPanel());
-        
-        
+        view.addPanelToSecondaryContainer(subPresenters[3].getContentPanel());
     }
 
     @Override
Index: src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/ProjectMapper.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/ProjectMapper.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/ProjectMapper.java	(working copy)
@@ -303,6 +303,7 @@
 				uDTO.setId(u.getId());
 				uDTO.setChangePasswordKey(u.getChangePasswordKey());
 				uDTO.setDateChangePasswordKeyIssued(u.getDateChangePasswordKeyIssued());
+				uDTO.setLastPasswordChange(u.getLastPasswordChange());
 				uDTO.setEmail(u.getEmail());
 				uDTO.setFirstName(u.getFirstName());
 				uDTO.setLocale(u.getLocale());
Index: src/main/java/org/sigmah/client/page/admin/management/AdminBackupManagementView.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminBackupManagementView.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminBackupManagementView.java	(working copy)
@@ -4,7 +4,7 @@
 import org.sigmah.client.page.admin.management.AdminBackupManagementPresenter.View;
 
 import com.extjs.gxt.ui.client.widget.ContentPanel;
-import com.google.gwt.user.client.ui.Button;
+import com.extjs.gxt.ui.client.widget.button.Button;
 import com.google.gwt.user.client.ui.FlexTable;
 import com.google.gwt.user.client.ui.HasHorizontalAlignment;
 import com.google.gwt.user.client.ui.ListBox;
Index: src/main/java/org/sigmah/client/PasswordChangePrompt.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/PasswordChangePrompt.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/PasswordChangePrompt.java	(working copy)
@@ -0,0 +1,123 @@
+package org.sigmah.client;
+
+import org.sigmah.client.dispatch.remote.Authentication;
+import org.sigmah.client.i18n.I18N;
+import org.sigmah.client.page.login.PasswordManagementService;
+import org.sigmah.client.page.login.PasswordManagementServiceAsync;
+import org.sigmah.client.util.Notification;
+
+import com.extjs.gxt.ui.client.Style.HorizontalAlignment;
+import com.extjs.gxt.ui.client.event.ButtonEvent;
+import com.extjs.gxt.ui.client.event.Events;
+import com.extjs.gxt.ui.client.event.Listener;
+import com.extjs.gxt.ui.client.widget.Dialog;
+import com.extjs.gxt.ui.client.widget.MessageBox;
+import com.extjs.gxt.ui.client.widget.button.Button;
+import com.extjs.gxt.ui.client.widget.form.FormPanel;
+import com.extjs.gxt.ui.client.widget.form.TextField;
+import com.google.gwt.core.client.GWT;
+import com.google.gwt.user.client.rpc.AsyncCallback;
+
+public class PasswordChangePrompt extends Dialog {
+	private Authentication auth;
+	
+	private Button updateButton;
+	
+	public PasswordChangePrompt(Authentication auth) {
+		this.auth = auth;
+		
+		buildLayout();
+	}
+
+	protected void buildLayout() {
+		setModal(true);
+		setPixelSize(350, 190);
+		setClosable(true);
+		setButtonAlign(HorizontalAlignment.CENTER);
+		
+		final TextField&lt;String&gt; emailBox = new TextField&lt;String&gt;();
+		final TextField&lt;String&gt; passwordTextBox = new TextField&lt;String&gt;();
+		final TextField&lt;String&gt; confirmPasswordTextBox = new TextField&lt;String&gt;();
+
+		emailBox.setValue(auth.getEmail());
+		emailBox.setFieldLabel(I18N.CONSTANTS.email());
+		emailBox.setAllowBlank(true);
+		emailBox.disable();
+		
+		passwordTextBox.setFieldLabel(I18N.CONSTANTS.password());
+		passwordTextBox.setAllowBlank(false);
+		passwordTextBox.setPassword(true);
+
+		confirmPasswordTextBox.setFieldLabel(I18N.CONSTANTS.confirmPassword());
+		confirmPasswordTextBox.setAllowBlank(false);
+		confirmPasswordTextBox.setPassword(true);
+
+		updateButton = new Button(I18N.CONSTANTS.save());
+		updateButton.addListener(Events.OnClick, new Listener&lt;ButtonEvent&gt;() {
+			@Override
+			public void handleEvent(ButtonEvent be) {
+				String password = passwordTextBox.getValue();
+				String passwordConfirmation = confirmPasswordTextBox.getValue();
+
+				if (password == null || password.length() == 0
+						|| passwordConfirmation == null
+						|| passwordConfirmation.length() == 0) {
+					MessageBox.alert(I18N.CONSTANTS.error(),
+							I18N.CONSTANTS.formWindowFieldsUnfilledDetails(),
+							null);
+					return;
+				} else if (!password.equals(passwordConfirmation)) {
+					MessageBox.alert(I18N.CONSTANTS.error(),
+							I18N.CONSTANTS.passwordNotMatch(), null);
+					return;
+				}
+
+				beforeChangePassword();
+
+				doChangePassword(password);
+			}
+		});
+		
+		FormPanel panel = new FormPanel();
+		panel.setHeaderVisible(false);
+		panel.add(emailBox);
+		panel.add(passwordTextBox);
+		panel.add(confirmPasswordTextBox);
+		
+		add(panel);
+	
+		getButtonBar().removeAll();
+		
+		addButton(updateButton);
+		
+		setFocusWidget(passwordTextBox);
+	}
+
+	protected void beforeChangePassword() {
+		mask(I18N.CONSTANTS.saving());
+		updateButton.setEnabled(false);
+	}
+	
+	protected void afterChangePassword() {
+		unmask();
+		updateButton.setEnabled(true);
+	}
+
+	protected void doChangePassword(String newPassword) {
+        final PasswordManagementServiceAsync service = GWT.create(PasswordManagementService.class);
+		service.updatePassword(auth.getEmail(), newPassword,
+				new AsyncCallback&lt;Void&gt;() {
+					@Override
+					public void onFailure(Throwable caught) {
+						afterChangePassword();
+						MessageBox.alert(I18N.CONSTANTS.save(), I18N.CONSTANTS.saveError(), null);
+					}
+
+					@Override
+					public void onSuccess(Void result) {
+						Notification.show(I18N.CONSTANTS.infoConfirmation(), I18N.CONSTANTS.passwordChanged());
+						hide();
+					}
+				});
+	}
+}
Index: src/main/java/org/sigmah/client/SigmahAppFrame.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/SigmahAppFrame.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/SigmahAppFrame.java	(working copy)
@@ -29,6 +29,8 @@
 import org.sigmah.client.page.common.widget.LoadingPlaceHolder;
 import org.sigmah.client.page.dashboard.DashboardPageState;
 import org.sigmah.client.page.login.LoginView;
+import org.sigmah.client.page.login.PasswordManagementService;
+import org.sigmah.client.page.login.PasswordManagementServiceAsync;
 import org.sigmah.client.ui.CreditFrame;
 import org.sigmah.client.ui.SigmahViewport;
 import org.sigmah.client.ui.Tab;
@@ -39,7 +41,9 @@
 import org.sigmah.shared.command.GetHostServerInfo;
 import org.sigmah.shared.command.result.ApplicationInfo;
 import org.sigmah.shared.command.result.HostServerInfo;
+import org.sigmah.shared.domain.profile.GlobalPermissionEnum;
 import org.sigmah.shared.dto.OrganizationDTO;
+import org.sigmah.shared.dto.profile.ProfileUtils;
 import org.sigmah.shared.dto.value.FileUploadUtils;
 
 import com.allen_sauer.gwt.log.client.Log;
@@ -128,6 +132,21 @@
 				}
 			});
 			RootPanel.get(&quot;help&quot;).add(helpButton);
+			
+			if (ProfileUtils.isGranted(auth, GlobalPermissionEnum.CHANGE_PASSWORD)) {
+				final Anchor changePasswordButton = new Anchor(I18N.CONSTANTS.changePassword());
+				changePasswordButton.addClickHandler(new ClickHandler() {
+					@Override
+					public void onClick(ClickEvent event) {
+						PasswordChangePrompt prompt = new PasswordChangePrompt(auth);
+						prompt.setHeading(I18N.CONSTANTS.changePassword());
+						prompt.show();
+					}
+				});
+				RootPanel.get(&quot;changePassword&quot;).add(changePasswordButton);
+			} else {
+				RootPanel.get(&quot;changePassword&quot;).setVisible(false);
+			}
 
 			// Logout action
 			final Anchor logoutButton = new Anchor(I18N.CONSTANTS.logout());
@@ -287,6 +306,25 @@
 					                e);
 				}
 			});
+
+	        final PasswordManagementServiceAsync service = GWT.create(PasswordManagementService.class);
+	        service.hasPasswordExpired(auth.getEmail(), new AsyncCallback&lt;Boolean&gt;() {
+				@Override
+				public void onSuccess(Boolean result) {
+					if (result != null &amp;&amp; result) {
+						PasswordChangePrompt prompt = new PasswordChangePrompt(auth);
+						prompt.setClosable(false);
+						prompt.setHeading(I18N.CONSTANTS.changePassword());
+						prompt.show();
+					}
+				}
+				
+				@Override
+				public void onFailure(Throwable e) {
+					Log.error(&quot;[execute] Error while getting the password expiration information for user #id &quot; + auth.getUserId() + &quot;.&quot;,
+			                e);
+				}
+			});
 		}
 	}
 
Index: src/main/java/org/sigmah/client/page/login/PasswordManagementService.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/login/PasswordManagementService.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/login/PasswordManagementService.java	(working copy)
@@ -16,5 +16,6 @@
 public interface PasswordManagementService extends RemoteService {
     void forgotPassword(String email, String language, String hostUrl) throws Exception;
     String validateAndGetUserEmailByToken(String token) throws Exception;
-    void updatePassword(String email,String password) throws Exception;
+    void updatePassword(String email, String password) throws Exception;
+	Boolean hasPasswordExpired(String email) throws Exception;
 }
Index: src/main/resources/org/sigmah/server/bootstrap/SigmahHostController.html
===================================================================
--- workspace_dev/Sigmah/src/main/resources/org/sigmah/server/bootstrap/SigmahHostController.html	(revision 1560)
+++ workspace_dev/Sigmah/src/main/resources/org/sigmah/server/bootstrap/SigmahHostController.html	(working copy)
@@ -87,7 +87,7 @@
     &lt;div class=&quot;sigmah&quot;&gt;
         &lt;div id=&quot;logout&quot;&gt;&lt;img src=&quot;image/deconnexion.png&quot; alt=&quot;&quot; /&gt; &lt;/div&gt;
         &lt;!-- hide credit frame --&gt;
-        &lt;div class=&quot;minimenu&quot;&gt; &lt;span id=&quot;credit&quot;&gt;&lt;/span&gt; &amp;#124 &lt;span id=&quot;bugreport&quot;&gt;&lt;/span&gt; &amp;#124 &lt;span id=&quot;help&quot;&gt;&lt;/span&gt; &lt;/div&gt;
+        &lt;div class=&quot;minimenu&quot;&gt; &lt;span id=&quot;credit&quot;&gt;&lt;/span&gt; &amp;#124 &lt;span id=&quot;bugreport&quot;&gt;&lt;/span&gt; &amp;#124 &lt;span id=&quot;help&quot;&gt;&lt;/span&gt; &lt;span id=&quot;changePassword&quot;&gt;&amp;#124 &lt;/span&gt; &lt;/div&gt;
         &lt;div id=&quot;offline-status&quot;&gt;&lt;/div&gt;
     &lt;/div&gt;
 &lt;/div&gt;
Index: src/main/java/org/sigmah/server/endpoint/gwtrpc/PasswordManagementServlet.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/PasswordManagementServlet.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/PasswordManagementServlet.java	(working copy)
@@ -23,8 +23,11 @@
 import org.sigmah.client.page.login.PasswordManagementService;
 import org.sigmah.server.auth.impl.BCrypt;
 import org.sigmah.server.dao.Transactional;
+import org.sigmah.server.dao.hibernate.PasswordExpirationPolicyHibernateDAO;
 import org.sigmah.server.mail.MailSender;
+import org.sigmah.shared.domain.Organization;
 import org.sigmah.shared.domain.User;
+import org.sigmah.shared.domain.password.PasswordExpirationPolicy;
 
 import com.google.gwt.user.server.rpc.RemoteServiceServlet;
 import com.google.inject.Inject;
@@ -64,10 +67,7 @@
 		
 		final EntityManager entityManager = injector.getInstance(EntityManager.class);
 
-		// find user
-		final Query query = entityManager.createQuery(&quot;SELECT u FROM User u WHERE u.email = :email&quot;);
-		query.setParameter(&quot;email&quot;, email);
-		final User user = (User) query.getSingleResult();
+		final User user = findUser(email, entityManager);
 		
 		// unique key is stored and sent by email
 		String uniqueKey = UUID.randomUUID().toString();
@@ -131,22 +131,43 @@
 	@Override
 	@Transactional
 	public void updatePassword(String email, String password) throws Exception {
-
 		final EntityManager entityManager = injector.getInstance(EntityManager.class);
 
-		final Query query = entityManager.createQuery(&quot;SELECT u FROM User u WHERE u.email = :email&quot;);
-		query.setParameter(&quot;email&quot;, email);
-
-		final User user = (User) query.getSingleResult();
+		final User user = findUser(email, entityManager);
 
 		final String hashedPassword = BCrypt.hashpw(password, BCrypt.gensalt());
 		user.setHashedPassword(hashedPassword);
+		user.setLastPasswordChange(new Date());
 		
 		// disactivate password change key
 		user.setChangePasswordKey(null);
 		
 		entityManager.merge(user);
-		log.info(String.format(&quot;User's(%s) password has been updated using password reset link&quot;,email));
+		log.info(String.format(&quot;User's(%s) password has been updated&quot;,email));
+	}
+	
+	@Override
+	public Boolean hasPasswordExpired(String email) throws Exception {
+		final EntityManager entityManager = injector.getInstance(EntityManager.class);
+
+		final User user = findUser(email, entityManager);
+		if (user.getLastPasswordChange() == null) { // new user
+			return true;
+		}
+
+		Organization organization = user.getOrganization();
+		if (organization == null) {
+			return false;
+		}
+		
+		final PasswordExpirationPolicy policy = new PasswordExpirationPolicyHibernateDAO(entityManager).getPasswordExpirationPolicyByOrganization(organization.getId());
+		return policy != null &amp;&amp; policy.isExpired(user.getLastPasswordChange());
+	}
+
+	protected User findUser(String email, final EntityManager entityManager) {
+		final Query query = entityManager.createQuery(&quot;SELECT u FROM User u WHERE u.email = :email&quot;);
+		query.setParameter(&quot;email&quot;, email);
+		return (User) query.getSingleResult();
 	}
 	
 	private Locale getLocale(final String key) {
Index: src/main/java/org/sigmah/client/page/login/PasswordManagementServiceAsync.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/login/PasswordManagementServiceAsync.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/login/PasswordManagementServiceAsync.java	(working copy)
@@ -12,9 +12,8 @@
  * @author RaphaÃ«l Calabro (rcalabro@ideia.fr)
  */
 public interface PasswordManagementServiceAsync {
-
     public void forgotPassword(String email, String language, String hostUrl, AsyncCallback&lt;Void&gt; asyncCallback);
     public void validateAndGetUserEmailByToken(String token, AsyncCallback&lt;String&gt; asyncCallback);
     public void updatePassword(String email,String password, AsyncCallback&lt;Void&gt; asyncCallback);
-
+    public void hasPasswordExpired(String email, AsyncCallback&lt;Boolean&gt; asyncCallback);
 }
Index: src/main/java/org/sigmah/shared/command/UpdatePasswordExpirationPolicy.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/command/UpdatePasswordExpirationPolicy.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/command/UpdatePasswordExpirationPolicy.java	(working copy)
@@ -0,0 +1,48 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.shared.command;
+
+import java.util.Date;
+
+import org.sigmah.shared.command.result.VoidResult;
+import org.sigmah.shared.domain.password.ExpirationPolicyEnum;
+
+/**
+ * @author renatoaf
+ */
+public class UpdatePasswordExpirationPolicy implements Command&lt;VoidResult&gt; {
+	private static final long serialVersionUID = -16062353382310195L;
+	
+	private int organizationId;
+	private ExpirationPolicyEnum type;
+	private Date referenceDate;
+
+	public UpdatePasswordExpirationPolicy() {
+	}
+
+	public ExpirationPolicyEnum getType() {
+		return type;
+	}
+	
+	public void setType(ExpirationPolicyEnum type) {
+		this.type = type;
+	}
+	
+	public int getOrganizationId() {
+		return organizationId;
+	}
+
+	public void setOrganizationId(int organizationId) {
+		this.organizationId = organizationId;
+	}
+	
+	public Date getReferenceDate() {
+		return referenceDate;
+	}
+	
+	public void setReferenceDate(Date referenceDate) {
+		this.referenceDate = referenceDate;
+	}
+}
Index: src/main/java/org/sigmah/client/page/admin/management/AdminPasswordExpirationPolicyManagementPresenter.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminPasswordExpirationPolicyManagementPresenter.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminPasswordExpirationPolicyManagementPresenter.java	(working copy)
@@ -0,0 +1,132 @@
+package org.sigmah.client.page.admin.management;
+
+import org.sigmah.client.cache.UserLocalCache;
+import org.sigmah.client.dispatch.Dispatcher;
+import org.sigmah.client.i18n.I18N;
+import org.sigmah.client.page.admin.management.AdminManagementPresenter.AdminManagementSubPresenter;
+import org.sigmah.client.util.Notification;
+import org.sigmah.shared.command.GetPasswordExpirationPolicy;
+import org.sigmah.shared.command.UpdatePasswordExpirationPolicy;
+import org.sigmah.shared.command.result.VoidResult;
+import org.sigmah.shared.domain.password.ExpirationPolicyEnum;
+import org.sigmah.shared.dto.PasswordExpirationPolicyDTO;
+
+import com.extjs.gxt.ui.client.event.BaseEvent;
+import com.extjs.gxt.ui.client.event.ButtonEvent;
+import com.extjs.gxt.ui.client.event.Events;
+import com.extjs.gxt.ui.client.event.Listener;
+import com.extjs.gxt.ui.client.event.SelectionListener;
+import com.extjs.gxt.ui.client.widget.ContentPanel;
+import com.extjs.gxt.ui.client.widget.MessageBox;
+import com.extjs.gxt.ui.client.widget.button.Button;
+import com.extjs.gxt.ui.client.widget.form.DateField;
+import com.extjs.gxt.ui.client.widget.form.SimpleComboBox;
+import com.google.gwt.user.client.rpc.AsyncCallback;
+import com.google.inject.Inject;
+
+/**
+ * Presenter of the password expiration policy settings page.
+ * 
+ * @author renatoaf
+ */
+public class AdminPasswordExpirationPolicyManagementPresenter implements AdminManagementSubPresenter {
+    public interface View {
+        ContentPanel getContentPanel();
+
+        SimpleComboBox&lt;ExpirationPolicyEnum&gt; getExpirationPolicyTypeCombo();
+
+        DateField getScheduledDateField();
+
+        Button getSaveButton();
+    }
+
+    private final View view;
+    private boolean valueChanged;
+
+    @Inject
+    public AdminPasswordExpirationPolicyManagementPresenter(final UserLocalCache cache, final View view, final Dispatcher dispatcher) {
+        this.view = view;
+
+        view.getSaveButton().addSelectionListener(new SelectionListener&lt;ButtonEvent&gt;() {
+            @Override
+            public void componentSelected(ButtonEvent ce) {
+                UpdatePasswordExpirationPolicy settings = new UpdatePasswordExpirationPolicy();
+                settings.setType(view.getExpirationPolicyTypeCombo().getSimpleValue());
+                settings.setOrganizationId(cache.getOrganizationCache().getOrganization().getId());
+                settings.setReferenceDate(view.getScheduledDateField().getValue());
+                
+                if (view.getScheduledDateField().isVisible() &amp;&amp; settings.getReferenceDate() == null) {
+                	MessageBox.alert(I18N.CONSTANTS.error(),
+	                        I18N.CONSTANTS.formWindowFieldsUnfilledDetails(), null);
+                	return;
+                }
+                
+                dispatcher.execute(settings, null, new AsyncCallback&lt;VoidResult&gt;() {
+                    @Override
+                    public void onFailure(Throwable caught) {
+                    	MessageBox.alert(I18N.CONSTANTS.savePasswordExpirationPolicyConfiguration(),
+		                        I18N.MESSAGES.adminStandardCreationFailure(
+		                        		I18N.CONSTANTS.passwordExpirationPolicy()), null);
+                    }
+                    
+                    @Override
+                    public void onSuccess(VoidResult result) {
+                        valueChanged = false;
+                        Notification.show(I18N.CONSTANTS.passwordExpirationPolicySaveChangesNotificationTitle(),
+                            I18N.CONSTANTS.passwordExpirationPolicySaveChangesNotificationMessage());
+                    }
+                });
+            }
+        });
+
+        Listener&lt;BaseEvent&gt; valueChangedListener = new Listener&lt;BaseEvent&gt;() {
+            @Override
+            public void handleEvent(BaseEvent be) {
+                valueChanged = true;
+            }
+        };
+
+        view.getExpirationPolicyTypeCombo().addListener(Events.SelectionChange, valueChangedListener);
+        view.getScheduledDateField().addListener(Events.Change, valueChangedListener);
+
+        final GetPasswordExpirationPolicy settingsCommand = new GetPasswordExpirationPolicy(cache.getOrganizationCache().getOrganization().getId());
+        dispatcher.execute(settingsCommand, null, new AsyncCallback&lt;PasswordExpirationPolicyDTO&gt;() {
+            @Override
+            public void onFailure(Throwable caught) {
+            	
+            }
+
+            @Override
+            public void onSuccess(PasswordExpirationPolicyDTO result) {
+            	view.getScheduledDateField().setValue(result.getReferenceDate());
+            	view.getExpirationPolicyTypeCombo().setSimpleValue(result.getType());
+                valueChanged = false;
+            }
+        });
+    }
+
+    @Override
+    public boolean hasValueChanged() {
+        return valueChanged;
+    }
+
+    @Override
+    public void forgetAllChangedValues() {
+        valueChanged = false;
+    }
+
+    @Override
+    public void setCurrentState() {
+
+    }
+
+    @Override
+    public ContentPanel getContentPanel() {
+        return view.getContentPanel();
+    }
+
+    @Override
+    public String getName() {
+        return I18N.CONSTANTS.passwordExpirationPolicy();
+    }
+}
Index: src/main/java/org/sigmah/shared/command/GetPasswordExpirationPolicy.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/command/GetPasswordExpirationPolicy.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/command/GetPasswordExpirationPolicy.java	(working copy)
@@ -0,0 +1,31 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.shared.command;
+
+import org.sigmah.shared.dto.PasswordExpirationPolicyDTO;
+
+/**
+ * @author renatoaf
+ */
+public class GetPasswordExpirationPolicy implements Command&lt;PasswordExpirationPolicyDTO&gt; {
+	private static final long serialVersionUID = 5367051796565604864L;
+
+	private int organizationId;
+
+	public GetPasswordExpirationPolicy() {
+	}
+
+	public GetPasswordExpirationPolicy(int organizationId) {
+		this.organizationId = organizationId;
+	}
+
+	public int getOrganizationId() {
+		return organizationId;
+	}
+
+	public void setOrganizationId(int organizationId) {
+		this.organizationId = organizationId;
+	}
+}
Index: src/main/java/org/sigmah/server/policy/UserPolicy.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/policy/UserPolicy.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/policy/UserPolicy.java	(working copy)
@@ -98,8 +98,10 @@
                 userToPersist.setHashedPassword(PasswordHelper.hashPassword(password));
                 userToPersist.setChangePasswordKey(null);
                 userToPersist.setDateChangePasswordKeyIssued(new Date());
+            	userToPersist.setLastPasswordChange(new Date());
             } else if (userFound != null){
             	userToPersist.setHashedPassword(userFound.getHashedPassword());
+            	userToPersist.setLastPasswordChange(userFound.getLastPasswordChange());
             }
 
             if (userFound != null &amp;&amp; userFound.getId() &gt; 0) {
Index: src/main/java/org/sigmah/public/sigmah.css
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/public/sigmah.css	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/public/sigmah.css	(working copy)
@@ -88,7 +88,7 @@
 #logout {
 	font-size: 11px;
 	height: 16px;
-	width: 92px;
+	width: 80px;
 	float: right;
 	text-align: right;
 	padding-top: 1px;
@@ -123,8 +123,8 @@
 
 .minimenu {
 	height: 16px;
-	width: 245px;
-	float: right;
+	width: 280px;
+/*	float: right; */
 	text-align: right;
 	padding-top: 1px;
 	color: #C2C1C1;
Index: src/main/java/org/sigmah/shared/dto/UserDTO.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/dto/UserDTO.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/dto/UserDTO.java	(working copy)
@@ -87,6 +87,14 @@
     	set(&quot;pwdChangeDate&quot;, pwdChangeDate);
     }
     
+    public Date getLastPasswordChange() {
+        return get(&quot;lastPasswordChange&quot;);
+    }
+
+    public void setLastPasswordChange(Date passwordChange) {
+    	set(&quot;lastPasswordChange&quot;, passwordChange);
+    }
+    
     public List&lt;ProfileDTO&gt; getProfilesDTO() {
     	return get(&quot;profilesDTO&quot;);
     }
Index: src/main/java/org/sigmah/shared/domain/password/ExpirationPolicyEnum.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/password/ExpirationPolicyEnum.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/password/ExpirationPolicyEnum.java	(working copy)
@@ -0,0 +1,88 @@
+package org.sigmah.shared.domain.password;
+
+import java.util.Date;
+
+import org.sigmah.client.i18n.I18N;
+
+/**
+ * Enumeration for password expiration policies.
+ * 
+ * @author renatoaf
+ */
+public enum ExpirationPolicyEnum {
+	WEEKLY {
+		@Override
+		public boolean isExpired(Date referenceDate, Date lastChange) {
+			Date currentDate = new Date();
+			return currentDate.getTime() - lastChange.getTime() &gt; WEEK;
+		}
+	},
+	
+	MONTHLY {
+		@Override
+		public boolean isExpired(Date referenceDate, Date lastChange) {
+			Date currentDate = new Date();
+			return currentDate.getTime() - lastChange.getTime() &gt; MONTH;
+		}
+	},
+	
+	YEARLY {
+		@Override
+		public boolean isExpired(Date referenceDate, Date lastChange) {
+			Date currentDate = new Date();
+			return currentDate.getTime() - lastChange.getTime() &gt; YEAR;
+		}
+	},
+	
+	SCHEDULED {
+		@Override
+		public boolean isExpired(Date referenceDate, Date lastChange) {
+			return lastChange.before(referenceDate);
+		}
+	},
+	
+	NEVER {
+		@Override
+		public boolean isExpired(Date referenceDate, Date date) {
+			return false;
+		}
+	};
+
+	private static final long SECOND = 1000;
+	private static final long MINUTE = 60 * SECOND;
+	private static final long HOUR = 60 * MINUTE;
+	private static final long DAY = 24 * HOUR;
+	private static final long WEEK = 7 * DAY;
+	private static final long MONTH = 30 * DAY;
+	private static final long YEAR = 365 * DAY;
+	
+	public abstract boolean isExpired(Date referenceDate, Date lastChange);
+	
+	public static String getName(ExpirationPolicyEnum policy) {
+		String policyName = null;
+		switch (policy) {
+		case WEEKLY:
+			policyName = I18N.CONSTANTS.weekly();
+			break;
+		case MONTHLY:
+			policyName = I18N.CONSTANTS.monthly();
+			break;
+		case YEARLY:
+			policyName = I18N.CONSTANTS.yearly();
+			break;
+		case NEVER:
+			policyName = I18N.CONSTANTS.never();
+			break;
+		case SCHEDULED:
+			policyName = I18N.CONSTANTS.scheduled();
+			break;
+		default:
+			policyName = &quot;default&quot;;
+		}
+		return policyName;
+	}
+	
+	public String toString() {
+		return getName(this);
+	}
+}
Index: src/main/java/org/sigmah/server/dao/PasswordExpirationPolicyDAO.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/dao/PasswordExpirationPolicyDAO.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/dao/PasswordExpirationPolicyDAO.java	(working copy)
@@ -0,0 +1,21 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.server.dao;
+
+import java.util.Date;
+
+import org.sigmah.shared.domain.password.ExpirationPolicyEnum;
+import org.sigmah.shared.domain.password.PasswordExpirationPolicy;
+
+/**
+ * DAO interface for password expiration policies.
+ * 
+ * @author renatoaf
+ */
+public interface PasswordExpirationPolicyDAO {
+	public PasswordExpirationPolicy getPasswordExpirationPolicyByOrganization(Integer id);
+
+	public void updateExpirationPolicy(Integer organizationId, ExpirationPolicyEnum expirationPolicyType, Date referenceDate);
+}
Index: src/main/java/org/sigmah/client/page/admin/management/AdminBackupManagementPresenter.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminBackupManagementPresenter.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminBackupManagementPresenter.java	(working copy)
@@ -9,13 +9,13 @@
 import org.sigmah.client.page.admin.management.AdminManagementPresenter.AdminManagementSubPresenter;
 import org.sigmah.shared.dto.OrgUnitDTOLight;
 
+import com.extjs.gxt.ui.client.event.ButtonEvent;
+import com.extjs.gxt.ui.client.event.SelectionListener;
 import com.extjs.gxt.ui.client.widget.ContentPanel;
+import com.extjs.gxt.ui.client.widget.button.Button;
 import com.google.gwt.core.client.GWT;
-import com.google.gwt.event.dom.client.ClickEvent;
-import com.google.gwt.event.dom.client.ClickHandler;
 import com.google.gwt.user.client.Window;
 import com.google.gwt.user.client.rpc.AsyncCallback;
-import com.google.gwt.user.client.ui.Button;
 import com.google.gwt.user.client.ui.ListBox;
 import com.google.gwt.user.client.ui.RadioButton;
 import com.google.inject.ImplementedBy;
@@ -80,10 +80,10 @@
         
         view.getLastVersionRadioButton().setValue(true);
         
-        view.getBackupButton().addClickHandler(new ClickHandler() {
-            
+        view.getBackupButton().addSelectionListener(new SelectionListener&lt;ButtonEvent&gt;() {
+
             @Override
-            public void onClick(ClickEvent arg0) {
+            public void componentSelected(ButtonEvent ce) {
                 StringBuilder stringBuilder = new StringBuilder(GWT.getModuleBaseURL() + &quot;backup&quot;);
                 stringBuilder.append(&quot;?&quot;);
                 stringBuilder.append(&quot;downloadVersions&quot;).append(&quot;=&quot;).append(view.getAllVersionsRadioButton().getValue());
@@ -92,8 +92,8 @@
                 
                 Window.open(stringBuilder.toString(), &quot;_parent&quot;, &quot;location=no&quot;);
                 
-            }
-        });
+			}
+		});
     }
     
     
Index: src/main/java/org/sigmah/shared/dto/PasswordExpirationPolicyDTO.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/dto/PasswordExpirationPolicyDTO.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/dto/PasswordExpirationPolicyDTO.java	(working copy)
@@ -0,0 +1,49 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.shared.dto;
+
+import java.util.Date;
+
+import org.sigmah.shared.domain.password.ExpirationPolicyEnum;
+
+import com.extjs.gxt.ui.client.data.BaseModelData;
+
+/**
+ * @author renatoaf
+ */
+public class PasswordExpirationPolicyDTO extends BaseModelData implements EntityDTO {
+	private static final long serialVersionUID = -2053511704247237670L;
+
+	@Override
+	public int getId() {
+		final Integer id = (Integer) get(&quot;id&quot;);
+		return id != null ? id : -1;
+	}
+
+	public void setId(int id) {
+		set(&quot;id&quot;, id);
+	}
+	
+	public ExpirationPolicyEnum getType() {
+		return get(&quot;type&quot;);
+	}
+
+	public void setType(ExpirationPolicyEnum type) {
+		set(&quot;type&quot;, type);
+	} 
+
+    public Date getReferenceDate() {
+		return get(&quot;referenceDate&quot;);
+	}
+    
+    public void setReferenceDate(Date referenceDate) {
+    	set(&quot;referenceDate&quot;, referenceDate);
+	}
+
+	@Override
+	public String getEntityName() {
+		return &quot;PasswordExpirationPolicy&quot;;
+	}
+}
Index: src/main/java/org/sigmah/client/page/admin/management/AdminCoreManagementPresenter.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminCoreManagementPresenter.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminCoreManagementPresenter.java	(working copy)
@@ -10,15 +10,15 @@
 import org.sigmah.shared.dto.OrganizationDTO;
 import org.sigmah.shared.dto.value.FileUploadUtils;
 
+import com.extjs.gxt.ui.client.event.ButtonEvent;
+import com.extjs.gxt.ui.client.event.SelectionListener;
 import com.extjs.gxt.ui.client.widget.ContentPanel;
+import com.extjs.gxt.ui.client.widget.button.Button;
 import com.google.gwt.core.client.GWT;
 import com.google.gwt.event.dom.client.ChangeEvent;
 import com.google.gwt.event.dom.client.ChangeHandler;
-import com.google.gwt.event.dom.client.ClickEvent;
-import com.google.gwt.event.dom.client.ClickHandler;
 import com.google.gwt.user.client.Window;
 import com.google.gwt.user.client.rpc.AsyncCallback;
-import com.google.gwt.user.client.ui.Button;
 import com.google.gwt.user.client.ui.FileUpload;
 import com.google.gwt.user.client.ui.FormPanel;
 import com.google.gwt.user.client.ui.FormPanel.SubmitCompleteEvent;
@@ -115,10 +115,10 @@
             }
         });
 
-        view.getSaveButton().addClickHandler(new ClickHandler() {
-
-            @Override
-            public void onClick(ClickEvent event) {
+        view.getSaveButton().addSelectionListener(new SelectionListener&lt;ButtonEvent&gt;() {
+        	
+        	@Override
+			public void componentSelected(ButtonEvent ce) {
                 if (view.getOrganizationNameTextBox().getText().isEmpty()) {
                     Window.alert(I18N.CONSTANTS.organizationManagementBlankNameNotificationError());
                 } else {
Index: src/main/java/org/sigmah/client/page/admin/management/AdminPasswordExpirationPolicyManagementView.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminPasswordExpirationPolicyManagementView.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminPasswordExpirationPolicyManagementView.java	(working copy)
@@ -0,0 +1,100 @@
+package org.sigmah.client.page.admin.management;
+
+import java.util.Arrays;
+import java.util.Date;
+
+import org.sigmah.client.i18n.I18N;
+import org.sigmah.client.page.admin.management.AdminPasswordExpirationPolicyManagementPresenter.View;
+import org.sigmah.shared.domain.password.ExpirationPolicyEnum;
+
+import com.extjs.gxt.ui.client.Style.HorizontalAlignment;
+import com.extjs.gxt.ui.client.event.SelectionChangedEvent;
+import com.extjs.gxt.ui.client.event.SelectionChangedListener;
+import com.extjs.gxt.ui.client.widget.ContentPanel;
+import com.extjs.gxt.ui.client.widget.button.Button;
+import com.extjs.gxt.ui.client.widget.form.ComboBox.TriggerAction;
+import com.extjs.gxt.ui.client.widget.form.DateField;
+import com.extjs.gxt.ui.client.widget.form.FormPanel;
+import com.extjs.gxt.ui.client.widget.form.SimpleComboBox;
+import com.extjs.gxt.ui.client.widget.form.SimpleComboValue;
+import com.extjs.gxt.ui.client.widget.layout.FormLayout;
+import com.google.inject.Inject;
+
+/**
+ * View for setting the password expiration policy.
+ * 
+ * @author renatoaf
+ */
+public class AdminPasswordExpirationPolicyManagementView extends ContentPanel implements View {
+    private final SimpleComboBox&lt;ExpirationPolicyEnum&gt; policyTypeCombo;
+    private final DateField scheduledDateField;
+    private final Button saveButton;
+
+    @Inject
+	public AdminPasswordExpirationPolicyManagementView() {
+		this.setHeading(I18N.CONSTANTS.passwordExpirationPolicy());
+		
+		final FormPanel panel = new FormPanel();
+        panel.setHeaderVisible(false);
+        
+        FormLayout layout = new FormLayout();
+        layout.setLabelWidth(150);
+        panel.setLayout(layout);
+        
+        // file format
+        policyTypeCombo = new SimpleComboBox&lt;ExpirationPolicyEnum&gt;();
+        policyTypeCombo.add(Arrays.asList(ExpirationPolicyEnum.values()));
+        policyTypeCombo.setTriggerAction(TriggerAction.ALL);
+        policyTypeCombo.setEditable(false);
+        policyTypeCombo.setAllowBlank(false);
+        policyTypeCombo.setFieldLabel(I18N.CONSTANTS.expirationPolicy());
+        policyTypeCombo.addSelectionChangedListener(new SelectionChangedListener&lt;SimpleComboValue&lt;ExpirationPolicyEnum&gt;&gt;() {
+			public void selectionChanged(
+					SelectionChangedEvent&lt;SimpleComboValue&lt;ExpirationPolicyEnum&gt;&gt; se) {
+				SimpleComboValue&lt;ExpirationPolicyEnum&gt; selectedItem = se.getSelectedItem();
+				if (selectedItem != null &amp;&amp; selectedItem.getValue() == ExpirationPolicyEnum.SCHEDULED) {
+					scheduledDateField.setVisible(true);
+				} else {
+					scheduledDateField.clear();
+					scheduledDateField.setVisible(false);
+				}
+			}
+		});
+        
+        scheduledDateField = new DateField();
+        scheduledDateField.setFieldLabel(I18N.CONSTANTS.date());
+        scheduledDateField.setMinValue(new Date());
+        scheduledDateField.setAllowBlank(false);
+
+        saveButton = new Button(I18N.CONSTANTS.save());
+        
+        panel.add(policyTypeCombo);
+        panel.add(scheduledDateField);
+        panel.getButtonBar().add(saveButton);
+        panel.setButtonAlign(HorizontalAlignment.CENTER);
+        panel.getButtonBar().setEnableOverflow(false);
+        
+        this.setBodyStyleName(&quot;width-of-parent&quot;);
+        this.add(panel);
+    }
+
+    @Override
+    public ContentPanel getContentPanel() {
+        return this;
+    }
+
+    @Override
+    public SimpleComboBox&lt;ExpirationPolicyEnum&gt; getExpirationPolicyTypeCombo() {
+    	return policyTypeCombo;
+    }
+
+    @Override
+    public DateField getScheduledDateField() {
+		return scheduledDateField;
+	}
+ 
+    @Override
+    public Button getSaveButton() {
+        return saveButton;
+    }
+}
Index: src/main/java/org/sigmah/client/page/admin/management/AdminExportManagementView.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminExportManagementView.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminExportManagementView.java	(working copy)
@@ -1,8 +1,5 @@
 package org.sigmah.client.page.admin.management;
 
-import java.util.HashMap;
-import java.util.Map;
-
 import org.sigmah.client.i18n.I18N;
 import org.sigmah.client.page.admin.management.AdminExportManagementPresenter.View;
 
Index: src/main/java/org/sigmah/client/page/admin/management/AdminCoreManagementView.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminCoreManagementView.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminCoreManagementView.java	(working copy)
@@ -4,8 +4,8 @@
 import org.sigmah.client.page.admin.management.AdminCoreManagementPresenter.View;
 
 import com.extjs.gxt.ui.client.widget.ContentPanel;
+import com.extjs.gxt.ui.client.widget.button.Button;
 import com.extjs.gxt.ui.client.widget.layout.FlowLayout;
-import com.google.gwt.user.client.ui.Button;
 import com.google.gwt.user.client.ui.FileUpload;
 import com.google.gwt.user.client.ui.FlexTable;
 import com.google.gwt.user.client.ui.FormPanel;
Index: src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/UpdatePasswordExpirationPolicyHandler.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/UpdatePasswordExpirationPolicyHandler.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/UpdatePasswordExpirationPolicyHandler.java	(working copy)
@@ -0,0 +1,46 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.server.endpoint.gwtrpc.handler;
+
+import javax.persistence.EntityManager;
+
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+import org.dozer.Mapper;
+import org.sigmah.server.dao.PasswordExpirationPolicyDAO;
+import org.sigmah.shared.command.UpdatePasswordExpirationPolicy;
+import org.sigmah.shared.command.handler.CommandHandler;
+import org.sigmah.shared.command.result.CommandResult;
+import org.sigmah.shared.domain.User;
+import org.sigmah.shared.domain.password.PasswordExpirationPolicy;
+import org.sigmah.shared.exception.CommandException;
+
+import com.google.inject.Inject;
+
+/**
+ * Updates {@link PasswordExpirationPolicy} from a given update command.
+ * 
+ * @author renatoaf
+ */
+public class UpdatePasswordExpirationPolicyHandler implements CommandHandler&lt;UpdatePasswordExpirationPolicy&gt; {
+	protected static final Log log = LogFactory.getLog(UpdatePasswordExpirationPolicyHandler.class);
+	
+	protected final PasswordExpirationPolicyDAO dao;
+	protected final EntityManager em;
+	protected final Mapper mapper;
+
+	@Inject
+	public UpdatePasswordExpirationPolicyHandler(PasswordExpirationPolicyDAO dao, EntityManager em, Mapper mapper) {
+		this.dao = dao;
+		this.em = em;
+		this.mapper = mapper;
+	}
+			
+	@Override
+	public CommandResult execute(UpdatePasswordExpirationPolicy cmd, User user) throws CommandException {
+		dao.updateExpirationPolicy(cmd.getOrganizationId(), cmd.getType(), cmd.getReferenceDate());
+		return null;
+	}
+}
Index: src/main/java/org/sigmah/shared/domain/User.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/User.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/User.java	(working copy)
@@ -5,11 +5,23 @@
 
 package org.sigmah.shared.domain;
 
-import org.sigmah.shared.domain.profile.OrgUnitProfile;
-
-import javax.persistence.*;
 import java.util.Date;
 
+import javax.persistence.Column;
+import javax.persistence.Entity;
+import javax.persistence.FetchType;
+import javax.persistence.GeneratedValue;
+import javax.persistence.GenerationType;
+import javax.persistence.Id;
+import javax.persistence.JoinColumn;
+import javax.persistence.ManyToOne;
+import javax.persistence.NamedQueries;
+import javax.persistence.NamedQuery;
+import javax.persistence.OneToOne;
+import javax.persistence.Table;
+
+import org.sigmah.shared.domain.profile.OrgUnitProfile;
+
 /**
  * Describes a user
  * 
@@ -35,6 +47,7 @@
     private String locale;
     private String changePasswordKey;
     private Date dateChangePasswordKeyIssued;
+    private Date lastPasswordChange;
     private String hashedPassword;
     private Organization organization;
     private OrgUnitProfile orgUnitWithProfiles;
@@ -153,6 +166,18 @@
         this.dateChangePasswordKeyIssued = dateChangePasswordKeyIssued;
     }
 
+    /**
+     * Gets the date on which the password was last changed.
+     */
+    @Column(name = &quot;last_password_change&quot;, nullable = true)
+    public Date getLastPasswordChange() {
+		return lastPasswordChange;
+	}
+    
+    public void setLastPasswordChange(Date lastPasswordChange) {
+		this.lastPasswordChange = lastPasswordChange;
+	}
+
     public void clearChangePasswordKey() {
         this.setChangePasswordKey(null);
         this.setDateChangePasswordKeyIssued(null);
Index: src/main/java/org/sigmah/server/dao/hibernate/PasswordExpirationPolicyHibernateDAO.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/dao/hibernate/PasswordExpirationPolicyHibernateDAO.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/dao/hibernate/PasswordExpirationPolicyHibernateDAO.java	(working copy)
@@ -0,0 +1,43 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.server.dao.hibernate;
+
+import java.util.Date;
+
+import javax.persistence.EntityManager;
+import javax.persistence.Query;
+
+import org.sigmah.server.dao.PasswordExpirationPolicyDAO;
+import org.sigmah.shared.domain.password.ExpirationPolicyEnum;
+import org.sigmah.shared.domain.password.PasswordExpirationPolicy;
+
+import com.google.inject.Inject;
+
+/**
+ * @author renatoaf
+ */
+public class PasswordExpirationPolicyHibernateDAO implements PasswordExpirationPolicyDAO {
+	private final EntityManager em;
+
+	@Inject
+	public PasswordExpirationPolicyHibernateDAO(EntityManager em) {
+		this.em = em;
+	}
+
+	@Override
+	public PasswordExpirationPolicy getPasswordExpirationPolicyByOrganization(Integer id) {
+		Query query = em.createQuery(&quot;FROM PasswordExpirationPolicy pep WHERE pep.organization.id = :id&quot;);
+		query.setParameter(&quot;id&quot;, id);
+		return (PasswordExpirationPolicy) query.getSingleResult();
+	}
+
+	@Override
+	public void updateExpirationPolicy(Integer organizationId, ExpirationPolicyEnum expirationPolicyType, Date referenceDate) {
+		PasswordExpirationPolicy policy = getPasswordExpirationPolicyByOrganization(organizationId);
+		policy.setType(expirationPolicyType);
+		policy.setReferenceDate(referenceDate);
+		em.merge(policy);
+	}
+}
Index: src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/GetPasswordExpirationPolicyHandler.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/GetPasswordExpirationPolicyHandler.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/GetPasswordExpirationPolicyHandler.java	(working copy)
@@ -0,0 +1,48 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.server.endpoint.gwtrpc.handler;
+
+import javax.persistence.EntityManager;
+
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+import org.dozer.Mapper;
+import org.sigmah.server.dao.PasswordExpirationPolicyDAO;
+import org.sigmah.shared.command.GetPasswordExpirationPolicy;
+import org.sigmah.shared.command.handler.CommandHandler;
+import org.sigmah.shared.command.result.CommandResult;
+import org.sigmah.shared.domain.User;
+import org.sigmah.shared.domain.password.PasswordExpirationPolicy;
+import org.sigmah.shared.dto.PasswordExpirationPolicyDTO;
+import org.sigmah.shared.exception.CommandException;
+
+import com.google.inject.Inject;
+
+/**
+ * Provides {@link PasswordExpirationPolicy} for a given command.
+ * 
+ * @author renatoaf
+ */
+public class GetPasswordExpirationPolicyHandler implements CommandHandler&lt;GetPasswordExpirationPolicy&gt; {
+	protected static final Log log = LogFactory.getLog(GetPasswordExpirationPolicyHandler.class);
+
+	protected final PasswordExpirationPolicyDAO dao;
+	protected final EntityManager em;
+	protected final Mapper mapper;
+
+	@Inject
+	public GetPasswordExpirationPolicyHandler(PasswordExpirationPolicyDAO dao, EntityManager em, Mapper mapper) {
+		this.dao = dao;
+		this.em = em;
+		this.mapper = mapper;
+	}
+
+	@Override
+	public CommandResult execute(GetPasswordExpirationPolicy cmd, User user) throws CommandException {
+		PasswordExpirationPolicy policy = dao.getPasswordExpirationPolicyByOrganization(cmd .getOrganizationId());
+		PasswordExpirationPolicyDTO result = mapper.map(policy, PasswordExpirationPolicyDTO.class);
+		return result;
+	}
+}
Index: src/main/java/org/sigmah/client/page/admin/AdminModule.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/AdminModule.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/AdminModule.java	(working copy)
@@ -8,6 +8,8 @@
 import org.sigmah.client.page.admin.management.AdminExportManagementView;
 import org.sigmah.client.page.admin.management.AdminManagementPresenter;
 import org.sigmah.client.page.admin.management.AdminManagementView;
+import org.sigmah.client.page.admin.management.AdminPasswordExpirationPolicyManagementPresenter;
+import org.sigmah.client.page.admin.management.AdminPasswordExpirationPolicyManagementView;
 import org.sigmah.client.page.admin.model.common.AdminOneModelPresenter;
 import org.sigmah.client.page.admin.model.common.AdminOneModelView;
 
@@ -23,6 +25,7 @@
 		bind(AdminCoreManagementPresenter.View.class).to(AdminCoreManagementView.class);
 		bind(AdminBackupManagementPresenter.View.class).to(AdminBackupManagementView.class);
 		bind(AdminExportManagementPresenter.View.class).to(AdminExportManagementView.class);
+		bind(AdminPasswordExpirationPolicyManagementPresenter.View.class).to(AdminPasswordExpirationPolicyManagementView.class);
 	}
 
 }
Index: src/main/java/org/sigmah/shared/domain/profile/GlobalPermissionEnum.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/profile/GlobalPermissionEnum.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/profile/GlobalPermissionEnum.java	(working copy)
@@ -123,7 +123,12 @@
 	/**
 	 * Show global export button in projects list
 	 */
-	GLOBAL_EXPORT;
+	GLOBAL_EXPORT,
+
+	/**
+	 * for changing own password
+	 */
+	CHANGE_PASSWORD;
 
 	public static String getName(GlobalPermissionEnum gp) {
 		String gpName = &quot;default&quot;;
@@ -191,7 +196,9 @@
 		case GLOBAL_EXPORT:
 			gpName = I18N.CONSTANTS.globalExport();
 			break;
-
+		case CHANGE_PASSWORD:
+			gpName = I18N.CONSTANTS.CHANGE_OWN_PASSWORD();
+			break;
 		default:
 			gpName = null;
 		}
@@ -238,6 +245,9 @@
 		case GLOBAL_EXPORT:
 			gpCategory = I18N.CONSTANTS.categoryOthers();
 			break;
+		case CHANGE_PASSWORD:
+			gpCategory = I18N.CONSTANTS.categoryOthers();
+			break;
 		default:
 			break;
 		}
Index: src/main/java/org/sigmah/client/page/admin/users/AdminUsersView.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/users/AdminUsersView.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/users/AdminUsersView.java	(working copy)
@@ -452,7 +452,7 @@
 		});
 		configs.add(column);
 
-		column = new ColumnConfig(&quot;pwdChangeDate&quot;, I18N.CONSTANTS.adminUsersDatePasswordChange(), 120);
+		column = new ColumnConfig(&quot;lastPasswordChange&quot;, I18N.CONSTANTS.adminUsersDatePasswordChange(), 120);
 		final DateTimeFormat format = DateUtils.DATE_SHORT;
 		column.setHeader(I18N.CONSTANTS.adminUsersDatePasswordChange());
 		column.setDateTimeFormat(format);
@@ -670,7 +670,7 @@
 	public ProfileSigmahForm showNewProfileForm(Window window, AsyncCallback&lt;CreateResult&gt; asyncCallback,
 	                ProfileDTO profileToUpdate) {
 		window.setHeading(I18N.CONSTANTS.adminProfileAdd());
-		window.setSize(550, 600);
+		window.setSize(550, 620);
 		window.setPlain(true);
 		window.setModal(true);
 		window.setBlinkModal(true);
Index: src/main/java/org/sigmah/server/dao/hibernate/HibernateModule.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/dao/hibernate/HibernateModule.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/dao/hibernate/HibernateModule.java	(working copy)
@@ -17,6 +17,7 @@
 import org.sigmah.server.dao.IndicatorDAO;
 import org.sigmah.server.dao.LocationDAO;
 import org.sigmah.server.dao.PartnerDAO;
+import org.sigmah.server.dao.PasswordExpirationPolicyDAO;
 import org.sigmah.server.dao.PersonalEventDAO;
 import org.sigmah.server.dao.ProjectReportDAO;
 import org.sigmah.server.dao.ReportDefinitionDAO;
@@ -98,6 +99,7 @@
         bind(PersonalEventDAO.class).to(PersonalEventHibernateDAO.class);
         bind(ProjectReportDAO.class).to(ProjectReportHibernateDAO.class);
         bind(GlobalExportDAO.class).to(GlobalExportHibernateDAO.class);
+        bind(PasswordExpirationPolicyDAO.class).to(PasswordExpirationPolicyHibernateDAO.class);
     }
 
     private &lt;T extends DAO&gt; void bindDAOProxy(Class&lt;T&gt; daoClass) {
Index: src/main/java/org/sigmah/shared/domain/password/PasswordExpirationPolicy.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/password/PasswordExpirationPolicy.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/password/PasswordExpirationPolicy.java	(working copy)
@@ -0,0 +1,80 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.shared.domain.password;
+
+import java.io.Serializable;
+import java.util.Date;
+
+import javax.persistence.Column;
+import javax.persistence.Entity;
+import javax.persistence.EnumType;
+import javax.persistence.Enumerated;
+import javax.persistence.GeneratedValue;
+import javax.persistence.GenerationType;
+import javax.persistence.Id;
+import javax.persistence.JoinColumn;
+import javax.persistence.ManyToOne;
+import javax.persistence.Table;
+
+import org.sigmah.shared.domain.Organization;
+
+/**
+ * Password expiration policy per organization.
+ * 
+ * @author renatoaf
+ */
+@Entity
+@Table(name = &quot;password_expiration_policy&quot;)
+public class PasswordExpirationPolicy implements Serializable {
+	private static final long serialVersionUID = -2722884637221828205L;
+
+	private Long id;
+	private ExpirationPolicyEnum type;
+	private Organization organization;
+	private Date referenceDate;
+	
+	@Column(name = &quot;policy_type&quot;, nullable = false)
+	@Enumerated(EnumType.STRING)
+	public ExpirationPolicyEnum getType() {
+		return type;
+	}
+
+	public void setType(ExpirationPolicyEnum type) {
+		this.type = type;
+	}
+
+	@Id
+	@GeneratedValue(strategy = GenerationType.AUTO)
+	public Long getId() {
+		return id;
+	}
+
+	public void setId(Long id) {
+		this.id = id;
+	}
+ 
+	@ManyToOne
+	@JoinColumn(name = &quot;organization_id&quot;, nullable = false)
+	public Organization getOrganization() {
+		return organization;
+	}
+
+	public void setOrganization(Organization organization) {
+		this.organization = organization;
+	}
+
+    @Column(name = &quot;reference_date&quot;, nullable = true)
+    public Date getReferenceDate() {
+		return referenceDate;
+	}
+    
+    public void setReferenceDate(Date referenceDate) {
+		this.referenceDate = referenceDate;
+	}
+
+	public boolean isExpired(Date lastPasswordChange) {
+		return getType().isExpired(getReferenceDate(), lastPasswordChange);
+	}
+}
Index: src/main/java/org/sigmah/client/i18n/UIConstants.properties
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/i18n/UIConstants.properties	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/i18n/UIConstants.properties	(working copy)
@@ -61,6 +61,8 @@
 
 EDIT_INDICATOR = Edit indicator
 
+CHANGE_OWN_PASSWORD = Change own password
+
 EDIT_OWN_REMINDERS = Edit own reminders
 
 EDIT_ALL_REMINDERS = Edit all reminders
@@ -2098,6 +2100,10 @@
 
 year = Year
 
+yearly = Yearly
+
+scheduled = Scheduled
+
 yes = Yes
 
 you = You
@@ -2388,4 +2394,17 @@
 #Name for permission not included in any catebory
 categoryNotMapped = Not in any Category
 
+#Label for the &quot;change own password&quot; option
+changePassword = Change your password
 
+#Text displayed when a user changes his password
+passwordChanged = Your password is successfully updated.
+
+#Labels displayed on password expiration policy configuration tab (administration)
+expirationPolicy = Expiration policy
+passwordExpirationPolicy = Password expiration policy
+savePasswordExpirationPolicyConfiguration = Password expiration policy configuration
+passwordExpirationPolicySaveChangesNotificationTitle = Changes saved
+passwordExpirationPolicySaveChangesNotificationMessage = Your changes are correctly saved !
+
+never = Never
\ No newline at end of file
</pre></span>
<br />
<a href="file_download79ca.php?file_id=179&amp;type=bug"><img src="images/fileicons/generic.gif" alt="? file icon" width="16" height="16" border="0" /></a>&#160;<a href="file_download79ca.php?file_id=179&amp;type=bug">438_scheme_updates.sql</a> [<a href="file_download79ca.php?file_id=179&amp;type=bug" target="_blank">^</a>] (917 bytes) <span class="italic">2014-05-27 05:44</span><br />
<a href="file_download6b03.php?file_id=201&amp;type=bug"><img src="images/fileicons/png.gif" alt="png file icon" width="16" height="16" border="0" /></a>&#160;<a href="file_download6b03.php?file_id=201&amp;type=bug">fix01 - frequency and new user policy.png</a> [<a href="file_download6b03.php?file_id=201&amp;type=bug" target="_blank">^</a>] (73,960 bytes) <span class="italic">2014-06-30 08:36</span>
<br /><a href="file_download6b03.php?file_id=201&amp;type=bug"><img alt="" style="border: 0; max-height:250px;" src="fix01%2520-%2520frequency%2520and%2520new%2520user%2520policy5957.png?file_id=201&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=201807250b64558637ab337ed841a508710f1c0c183aa8d1" /></a><br />
<br /><a href="file_downloadc51d.php?file_id=202&amp;type=bug"><img src="images/fileicons/png.gif" alt="png file icon" width="16" height="16" border="0" /></a>&#160;<a href="file_downloadc51d.php?file_id=202&amp;type=bug">fix02 - current password.png</a> [<a href="file_downloadc51d.php?file_id=202&amp;type=bug" target="_blank">^</a>] (69,731 bytes) <span class="italic">2014-06-30 08:37</span>
<br /><a href="file_downloadc51d.php?file_id=202&amp;type=bug"><img alt="" style="border: 0; max-height:250px;" src="fix02%2520-%2520current%2520passworda26a.png?file_id=202&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=201807250446233cb42d37c2ae8d510b2aa53215e81f41a8" /></a><br />
<br /><a href="file_download07d4.php?file_id=203&amp;type=bug"><img src="images/fileicons/text.html" alt="txt file icon" width="16" height="16" border="0" /></a>&#160;<a href="file_download07d4.php?file_id=203&amp;type=bug">438_patch_v2.txt</a> [<a href="file_download07d4.php?file_id=203&amp;type=bug" target="_blank">^</a>] (71,050 bytes) <span class="italic">2014-06-30 08:37</span><script type="text/javascript" language="JavaScript">
<!--
function swap_content( span ) {
displayType = ( document.getElementById( span ).style.display == 'none' ) ? '' : 'none';
document.getElementById( span ).style.display = displayType;
}

 -->
 </script> <span id="hideSection_203">[<a class="small" href='#' id='attmlink_203' onclick='swap_content("hideSection_203");swap_content("showSection_203");return false;'>Show Content</a>]</span> <span style='display:none' id="showSection_203">[<a class="small" href='#' id='attmlink_203' onclick='swap_content("hideSection_203");swap_content("showSection_203");return false;'>Hide Content</a>]<pre>### Eclipse Workspace Patch 1.0
#P Sigmah
Index: src/main/java/org/sigmah/client/SigmahInjector.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/SigmahInjector.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/SigmahInjector.java	(working copy)
@@ -18,6 +18,7 @@
 import org.sigmah.client.page.admin.management.AdminCoreManagementPresenter;
 import org.sigmah.client.page.admin.management.AdminExportManagementPresenter;
 import org.sigmah.client.page.admin.management.AdminManagementPresenter;
+import org.sigmah.client.page.admin.management.AdminPasswordExpirationPolicyManagementPresenter;
 import org.sigmah.client.page.admin.model.common.AdminOneModelPresenter;
 import org.sigmah.client.page.charts.ChartPagePresenter;
 import org.sigmah.client.page.charts.SigmahChartLoader;
@@ -103,6 +104,7 @@
     AdminCoreManagementPresenter getAdminCoreManagementPresenter();
     AdminBackupManagementPresenter getAdminBackupManagementPresenter();
     AdminExportManagementPresenter getAdminExportManagementPresenter();
+    AdminPasswordExpirationPolicyManagementPresenter getAdminPasswordExpirationPolicyManagementPresenter();
     
     // Pages from ActivityInfo
     DataEntryLoader registerDataEntryLoader();
Index: src/main/java/org/sigmah/client/page/admin/management/AdminExportManagementPresenter.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminExportManagementPresenter.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminExportManagementPresenter.java	(working copy)
@@ -1,7 +1,5 @@
 package org.sigmah.client.page.admin.management;
 
-import java.util.Map;
-
 import org.sigmah.client.cache.UserLocalCache;
 import org.sigmah.client.dispatch.Dispatcher;
 import org.sigmah.client.i18n.I18N;
Index: src/main/java/org/sigmah/client/page/admin/management/AdminManagementPresenter.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminManagementPresenter.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminManagementPresenter.java	(working copy)
@@ -6,13 +6,8 @@
 import org.sigmah.client.page.admin.AdminPageState;
 import org.sigmah.client.page.admin.AdminSubPresenter;
 
-import com.extjs.gxt.ui.client.Style.LayoutRegion;
-import com.extjs.gxt.ui.client.util.Margins;
 import com.extjs.gxt.ui.client.widget.Component;
 import com.extjs.gxt.ui.client.widget.ContentPanel;
-import com.extjs.gxt.ui.client.widget.LayoutContainer;
-import com.extjs.gxt.ui.client.widget.layout.HBoxLayout;
-import com.extjs.gxt.ui.client.widget.layout.HBoxLayoutData;
 import com.google.inject.Inject;
 
 /**
@@ -52,20 +47,24 @@
         subPresenters = new AdminManagementSubPresenter[] {
                                                            injector.getAdminCoreManagementPresenter(),
                                                            injector.getAdminBackupManagementPresenter(),
-                                                           injector.getAdminExportManagementPresenter()};        
+                                                           injector.getAdminExportManagementPresenter(),
+                                                           injector.getAdminPasswordExpirationPolicyManagementPresenter()
+                                                          };        
         
         subPresenters[0].getContentPanel().setWidth(&quot;45%&quot;);
         subPresenters[1].getContentPanel().setWidth(&quot;55%&quot;);
-        subPresenters[2].getContentPanel().setWidth(&quot;100%&quot;);
+        subPresenters[2].getContentPanel().setWidth(&quot;45%&quot;);
+        subPresenters[3].getContentPanel().setWidth(&quot;55%&quot;);
 
         subPresenters[0].getContentPanel().setHeight(250);
         subPresenters[1].getContentPanel().setHeight(250);
         subPresenters[2].getContentPanel().setHeight(5000);
+        subPresenters[3].getContentPanel().setHeight(5000);
+        
         view.addPanelToMainContainer(subPresenters[0].getContentPanel());
         view.addPanelToMainContainer(subPresenters[1].getContentPanel());
         view.addPanelToSecondaryContainer(subPresenters[2].getContentPanel());
-        
-        
+        view.addPanelToSecondaryContainer(subPresenters[3].getContentPanel());
     }
 
     @Override
Index: src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/ProjectMapper.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/ProjectMapper.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/ProjectMapper.java	(working copy)
@@ -303,6 +303,7 @@
 				uDTO.setId(u.getId());
 				uDTO.setChangePasswordKey(u.getChangePasswordKey());
 				uDTO.setDateChangePasswordKeyIssued(u.getDateChangePasswordKeyIssued());
+				uDTO.setLastPasswordChange(u.getLastPasswordChange());
 				uDTO.setEmail(u.getEmail());
 				uDTO.setFirstName(u.getFirstName());
 				uDTO.setLocale(u.getLocale());
Index: src/main/java/org/sigmah/shared/exception/IllegalPasswordChangeException.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/exception/IllegalPasswordChangeException.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/exception/IllegalPasswordChangeException.java	(working copy)
@@ -0,0 +1,8 @@
+package org.sigmah.shared.exception;
+
+public class IllegalPasswordChangeException extends Exception {
+	private static final long serialVersionUID = 2370518229751807943L;
+
+	public IllegalPasswordChangeException() {
+	}
+}
Index: src/main/java/org/sigmah/client/PasswordChangePrompt.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/PasswordChangePrompt.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/PasswordChangePrompt.java	(working copy)
@@ -0,0 +1,143 @@
+package org.sigmah.client;
+
+import org.sigmah.client.dispatch.remote.Authentication;
+import org.sigmah.client.i18n.I18N;
+import org.sigmah.client.page.login.PasswordManagementService;
+import org.sigmah.client.page.login.PasswordManagementServiceAsync;
+import org.sigmah.client.util.Notification;
+import org.sigmah.shared.exception.IllegalPasswordChangeException;
+import org.sigmah.shared.exception.WrongPasswordException;
+
+import com.extjs.gxt.ui.client.Style.HorizontalAlignment;
+import com.extjs.gxt.ui.client.event.ButtonEvent;
+import com.extjs.gxt.ui.client.event.Events;
+import com.extjs.gxt.ui.client.event.Listener;
+import com.extjs.gxt.ui.client.widget.Dialog;
+import com.extjs.gxt.ui.client.widget.MessageBox;
+import com.extjs.gxt.ui.client.widget.button.Button;
+import com.extjs.gxt.ui.client.widget.form.FormPanel;
+import com.extjs.gxt.ui.client.widget.form.TextField;
+import com.google.gwt.core.client.GWT;
+import com.google.gwt.user.client.rpc.AsyncCallback;
+
+public class PasswordChangePrompt extends Dialog {
+	private Authentication auth;
+	
+	private Button updateButton;
+	
+	public PasswordChangePrompt(Authentication auth, boolean askCurrentPassword) {
+		this.auth = auth;
+		
+		buildLayout(askCurrentPassword);
+	}
+
+	protected void buildLayout(final boolean askForCurrentPassword) {
+		setModal(true);
+		setPixelSize(350, 215);
+		setClosable(true);
+		setButtonAlign(HorizontalAlignment.CENTER);
+		
+		final TextField&lt;String&gt; emailBox = new TextField&lt;String&gt;();
+		final TextField&lt;String&gt; currentPasswordTextBox = new TextField&lt;String&gt;();
+		final TextField&lt;String&gt; passwordTextBox = new TextField&lt;String&gt;();
+		final TextField&lt;String&gt; confirmPasswordTextBox = new TextField&lt;String&gt;();
+
+		emailBox.setValue(auth.getEmail());
+		emailBox.setFieldLabel(I18N.CONSTANTS.email());
+		emailBox.setAllowBlank(true);
+		emailBox.disable();
+		
+		currentPasswordTextBox.setFieldLabel(I18N.CONSTANTS.currentPassword());
+		currentPasswordTextBox.setAllowBlank(false);
+		currentPasswordTextBox.setPassword(true);
+		currentPasswordTextBox.setVisible(askForCurrentPassword);
+		
+		passwordTextBox.setFieldLabel(I18N.CONSTANTS.newPassword());
+		passwordTextBox.setAllowBlank(false);
+		passwordTextBox.setPassword(true);
+
+		confirmPasswordTextBox.setFieldLabel(I18N.CONSTANTS.confirmPassword());
+		confirmPasswordTextBox.setAllowBlank(false);
+		confirmPasswordTextBox.setPassword(true);
+
+		updateButton = new Button(I18N.CONSTANTS.save());
+		updateButton.addListener(Events.OnClick, new Listener&lt;ButtonEvent&gt;() {
+			@Override
+			public void handleEvent(ButtonEvent be) {
+				String currentPassword = currentPasswordTextBox.getValue();
+				String password = passwordTextBox.getValue();
+				String passwordConfirmation = confirmPasswordTextBox.getValue();
+
+				if (password == null || password.length() == 0
+						|| passwordConfirmation == null || passwordConfirmation.length() == 0
+						|| (askForCurrentPassword &amp;&amp; (currentPassword == null || currentPassword.length() == 0))) {
+					MessageBox.alert(I18N.CONSTANTS.error(),
+							I18N.CONSTANTS.formWindowFieldsUnfilledDetails(),
+							null);
+					return;
+				} else if (!password.equals(passwordConfirmation)) {
+					MessageBox.alert(I18N.CONSTANTS.error(),
+							I18N.CONSTANTS.passwordNotMatch(), null);
+					return;
+				}
+
+				beforeChangePassword();
+
+				doChangePassword(currentPassword, password, askForCurrentPassword);
+			}
+		});
+		
+		FormPanel panel = new FormPanel();
+		panel.setHeaderVisible(false);
+		panel.add(emailBox);
+		panel.add(currentPasswordTextBox);
+		panel.add(passwordTextBox);
+		panel.add(confirmPasswordTextBox);
+		
+		add(panel);
+	
+		getButtonBar().removeAll();
+		
+		addButton(updateButton);
+		
+		if (askForCurrentPassword) {
+			setFocusWidget(currentPasswordTextBox);
+		} else {
+			setFocusWidget(passwordTextBox);
+		}
+	}
+
+	protected void beforeChangePassword() {
+		mask(I18N.CONSTANTS.saving());
+		updateButton.setEnabled(false);
+	}
+	
+	protected void afterChangePassword() {
+		unmask();
+		updateButton.setEnabled(true);
+	}
+
+	protected void doChangePassword(String currentPassword, String newPassword, boolean validateOldPassword) {
+        final PasswordManagementServiceAsync service = GWT.create(PasswordManagementService.class);
+		service.changePassword(auth.getEmail(), currentPassword, newPassword, validateOldPassword,
+				new AsyncCallback&lt;Void&gt;() {
+					@Override
+					public void onFailure(Throwable caught) {
+						afterChangePassword();
+						if (caught instanceof IllegalPasswordChangeException) {
+							MessageBox.alert(I18N.CONSTANTS.error(), I18N.CONSTANTS.illegalPasswordChange(), null);
+						} else if (caught instanceof WrongPasswordException) {
+							MessageBox.alert(I18N.CONSTANTS.error(), I18N.CONSTANTS.wrongPassword(), null);
+						} else {
+							MessageBox.alert(I18N.CONSTANTS.save(), I18N.CONSTANTS.saveError(), null);
+						}
+					}
+
+					@Override
+					public void onSuccess(Void result) {
+						Notification.show(I18N.CONSTANTS.infoConfirmation(), I18N.CONSTANTS.passwordChanged());
+						hide();
+					}
+				});
+	}
+}
Index: src/main/java/org/sigmah/client/page/admin/management/AdminBackupManagementView.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminBackupManagementView.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminBackupManagementView.java	(working copy)
@@ -4,7 +4,7 @@
 import org.sigmah.client.page.admin.management.AdminBackupManagementPresenter.View;
 
 import com.extjs.gxt.ui.client.widget.ContentPanel;
-import com.google.gwt.user.client.ui.Button;
+import com.extjs.gxt.ui.client.widget.button.Button;
 import com.google.gwt.user.client.ui.FlexTable;
 import com.google.gwt.user.client.ui.HasHorizontalAlignment;
 import com.google.gwt.user.client.ui.ListBox;
Index: src/main/java/org/sigmah/client/SigmahAppFrame.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/SigmahAppFrame.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/SigmahAppFrame.java	(working copy)
@@ -29,6 +29,8 @@
 import org.sigmah.client.page.common.widget.LoadingPlaceHolder;
 import org.sigmah.client.page.dashboard.DashboardPageState;
 import org.sigmah.client.page.login.LoginView;
+import org.sigmah.client.page.login.PasswordManagementService;
+import org.sigmah.client.page.login.PasswordManagementServiceAsync;
 import org.sigmah.client.ui.CreditFrame;
 import org.sigmah.client.ui.SigmahViewport;
 import org.sigmah.client.ui.Tab;
@@ -39,7 +41,9 @@
 import org.sigmah.shared.command.GetHostServerInfo;
 import org.sigmah.shared.command.result.ApplicationInfo;
 import org.sigmah.shared.command.result.HostServerInfo;
+import org.sigmah.shared.domain.profile.GlobalPermissionEnum;
 import org.sigmah.shared.dto.OrganizationDTO;
+import org.sigmah.shared.dto.profile.ProfileUtils;
 import org.sigmah.shared.dto.value.FileUploadUtils;
 
 import com.allen_sauer.gwt.log.client.Log;
@@ -128,6 +132,21 @@
 				}
 			});
 			RootPanel.get(&quot;help&quot;).add(helpButton);
+			
+			if (ProfileUtils.isGranted(auth, GlobalPermissionEnum.CHANGE_PASSWORD)) {
+				final Anchor changePasswordButton = new Anchor(I18N.CONSTANTS.changePassword());
+				changePasswordButton.addClickHandler(new ClickHandler() {
+					@Override
+					public void onClick(ClickEvent event) {
+						PasswordChangePrompt prompt = new PasswordChangePrompt(auth, true);
+						prompt.setHeading(I18N.CONSTANTS.changePassword());
+						prompt.show();
+					}
+				});
+				RootPanel.get(&quot;changePassword&quot;).add(changePasswordButton);
+			} else {
+				RootPanel.get(&quot;changePassword&quot;).setVisible(false);
+			}
 
 			// Logout action
 			final Anchor logoutButton = new Anchor(I18N.CONSTANTS.logout());
@@ -287,6 +306,25 @@
 					                e);
 				}
 			});
+
+	        final PasswordManagementServiceAsync service = GWT.create(PasswordManagementService.class);
+	        service.hasPasswordExpired(auth.getEmail(), new AsyncCallback&lt;Boolean&gt;() {
+				@Override
+				public void onSuccess(Boolean result) {
+					if (result != null &amp;&amp; result) {
+						PasswordChangePrompt prompt = new PasswordChangePrompt(auth, false);
+						prompt.setClosable(false);
+						prompt.setHeading(I18N.CONSTANTS.changePassword());
+						prompt.show();
+					}
+				}
+				
+				@Override
+				public void onFailure(Throwable e) {
+					Log.error(&quot;[execute] Error while getting the password expiration information for user #id &quot; + auth.getUserId() + &quot;.&quot;,
+			                e);
+				}
+			});
 		}
 	}
 
Index: src/main/java/org/sigmah/client/page/login/PasswordManagementService.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/login/PasswordManagementService.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/login/PasswordManagementService.java	(working copy)
@@ -16,5 +16,7 @@
 public interface PasswordManagementService extends RemoteService {
     void forgotPassword(String email, String language, String hostUrl) throws Exception;
     String validateAndGetUserEmailByToken(String token) throws Exception;
-    void updatePassword(String email,String password) throws Exception;
+    void updatePassword(String email, String password) throws Exception;
+    void changePassword(String email, String oldPassword, String newPassword, Boolean validateOldPassword) throws Exception;
+	Boolean hasPasswordExpired(String email) throws Exception;
 }
Index: src/main/resources/org/sigmah/server/bootstrap/SigmahHostController.html
===================================================================
--- workspace_dev/Sigmah/src/main/resources/org/sigmah/server/bootstrap/SigmahHostController.html	(revision 1560)
+++ workspace_dev/Sigmah/src/main/resources/org/sigmah/server/bootstrap/SigmahHostController.html	(working copy)
@@ -87,7 +87,7 @@
     &lt;div class=&quot;sigmah&quot;&gt;
         &lt;div id=&quot;logout&quot;&gt;&lt;img src=&quot;image/deconnexion.png&quot; alt=&quot;&quot; /&gt; &lt;/div&gt;
         &lt;!-- hide credit frame --&gt;
-        &lt;div class=&quot;minimenu&quot;&gt; &lt;span id=&quot;credit&quot;&gt;&lt;/span&gt; &amp;#124 &lt;span id=&quot;bugreport&quot;&gt;&lt;/span&gt; &amp;#124 &lt;span id=&quot;help&quot;&gt;&lt;/span&gt; &lt;/div&gt;
+        &lt;div class=&quot;minimenu&quot;&gt; &lt;span id=&quot;credit&quot;&gt;&lt;/span&gt; &amp;#124 &lt;span id=&quot;bugreport&quot;&gt;&lt;/span&gt; &amp;#124 &lt;span id=&quot;help&quot;&gt;&lt;/span&gt; &lt;span id=&quot;changePassword&quot;&gt;&amp;#124 &lt;/span&gt; &lt;/div&gt;
         &lt;div id=&quot;offline-status&quot;&gt;&lt;/div&gt;
     &lt;/div&gt;
 &lt;/div&gt;
Index: src/main/java/org/sigmah/server/endpoint/gwtrpc/PasswordManagementServlet.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/PasswordManagementServlet.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/PasswordManagementServlet.java	(working copy)
@@ -23,8 +23,13 @@
 import org.sigmah.client.page.login.PasswordManagementService;
 import org.sigmah.server.auth.impl.BCrypt;
 import org.sigmah.server.dao.Transactional;
+import org.sigmah.server.dao.hibernate.PasswordExpirationPolicyHibernateDAO;
 import org.sigmah.server.mail.MailSender;
+import org.sigmah.shared.domain.Organization;
 import org.sigmah.shared.domain.User;
+import org.sigmah.shared.domain.password.PasswordExpirationPolicy;
+import org.sigmah.shared.exception.IllegalPasswordChangeException;
+import org.sigmah.shared.exception.WrongPasswordException;
 
 import com.google.gwt.user.server.rpc.RemoteServiceServlet;
 import com.google.inject.Inject;
@@ -64,10 +69,7 @@
 		
 		final EntityManager entityManager = injector.getInstance(EntityManager.class);
 
-		// find user
-		final Query query = entityManager.createQuery(&quot;SELECT u FROM User u WHERE u.email = :email&quot;);
-		query.setParameter(&quot;email&quot;, email);
-		final User user = (User) query.getSingleResult();
+		final User user = findUser(email, entityManager);
 		
 		// unique key is stored and sent by email
 		String uniqueKey = UUID.randomUUID().toString();
@@ -125,28 +127,81 @@
 		return user.getEmail();
 	}
 
+	@Override
+	@Transactional
+	public void changePassword(String email, String oldPassword, String newPassword, Boolean validateOldPassword) throws Exception {
+		final EntityManager entityManager = injector.getInstance(EntityManager.class);
+
+		final User user = findUser(email, entityManager);
+
+		if (validateOldPassword &amp;&amp; !BCrypt.checkpw(oldPassword, user.getHashedPassword())) {
+			throw new WrongPasswordException();
+		}
+
+		if (BCrypt.checkpw(newPassword, user.getHashedPassword())) {
+			throw new IllegalPasswordChangeException();
+		}
+		
+		updatePassword(email, newPassword);
+	}
+
 	/*
 	 * Updates user's password using email and a new password 
 	 */
 	@Override
 	@Transactional
 	public void updatePassword(String email, String password) throws Exception {
-
 		final EntityManager entityManager = injector.getInstance(EntityManager.class);
 
-		final Query query = entityManager.createQuery(&quot;SELECT u FROM User u WHERE u.email = :email&quot;);
-		query.setParameter(&quot;email&quot;, email);
-
-		final User user = (User) query.getSingleResult();
+		final User user = findUser(email, entityManager);
 
 		final String hashedPassword = BCrypt.hashpw(password, BCrypt.gensalt());
+		
 		user.setHashedPassword(hashedPassword);
+		user.setLastPasswordChange(new Date());
 		
 		// disactivate password change key
 		user.setChangePasswordKey(null);
 		
 		entityManager.merge(user);
-		log.info(String.format(&quot;User's(%s) password has been updated using password reset link&quot;,email));
+		log.info(String.format(&quot;User's(%s) password has been updated&quot;,email));
+	}
+	
+	@Override
+	@Transactional
+	public Boolean hasPasswordExpired(String email) throws Exception {
+		final EntityManager entityManager = injector.getInstance(EntityManager.class);
+
+		User user = findUser(email, entityManager);
+
+		Organization organization = user.getOrganization();
+		if (organization == null) {
+			log.warn(&quot;ERROR: No organization registered.&quot;);
+			return false;
+		}
+		
+		final PasswordExpirationPolicy policy = new PasswordExpirationPolicyHibernateDAO(entityManager).getPasswordExpirationPolicyByOrganization(organization.getId());
+		if (policy == null) {
+			log.warn(&quot;ERROR: No password expiration policy registered.&quot;);
+			return false;
+		}
+		
+		Date lastPasswordChange = user.getLastPasswordChange();
+		if (lastPasswordChange == null) { // new user
+			if (policy.isResetNewUserPassword()) {
+				return true;
+			} else {
+				user.setLastPasswordChange(new Date());
+				entityManager.merge(user);
+				return false;
+			}
+		}
+		return policy.isExpired(lastPasswordChange);
+	}
+
+	private User findUser(String email, final EntityManager entityManager) {
+		final Query query = entityManager.createQuery(&quot;SELECT u FROM User u WHERE u.email = :email&quot;).setParameter(&quot;email&quot;, email);
+		return (User) query.getSingleResult();
 	}
 	
 	private Locale getLocale(final String key) {
@@ -157,5 +212,4 @@
 
 		return locale;
 	}
-
 }
Index: src/main/java/org/sigmah/client/page/login/PasswordManagementServiceAsync.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/login/PasswordManagementServiceAsync.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/login/PasswordManagementServiceAsync.java	(working copy)
@@ -12,9 +12,9 @@
  * @author RaphaÃ«l Calabro (rcalabro@ideia.fr)
  */
 public interface PasswordManagementServiceAsync {
-
     public void forgotPassword(String email, String language, String hostUrl, AsyncCallback&lt;Void&gt; asyncCallback);
     public void validateAndGetUserEmailByToken(String token, AsyncCallback&lt;String&gt; asyncCallback);
     public void updatePassword(String email,String password, AsyncCallback&lt;Void&gt; asyncCallback);
-
+    public void changePassword(String email, String oldPassword, String newPassword, Boolean validateOldPassword, AsyncCallback&lt;Void&gt; asyncCallback);
+    public void hasPasswordExpired(String email, AsyncCallback&lt;Boolean&gt; asyncCallback);
 }
Index: src/main/java/org/sigmah/shared/command/UpdatePasswordExpirationPolicy.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/command/UpdatePasswordExpirationPolicy.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/command/UpdatePasswordExpirationPolicy.java	(working copy)
@@ -0,0 +1,66 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.shared.command;
+
+import java.util.Date;
+
+import org.sigmah.shared.command.result.VoidResult;
+import org.sigmah.shared.domain.password.ExpirationPolicyEnum;
+
+/**
+ * @author renatoaf
+ */
+public class UpdatePasswordExpirationPolicy implements Command&lt;VoidResult&gt; {
+	private static final long serialVersionUID = -16062353382310195L;
+	
+	private int organizationId;
+	private ExpirationPolicyEnum type;
+	private Date referenceDate;
+	private Integer frequency;
+	private Boolean resetNewUserPassword;
+
+	public UpdatePasswordExpirationPolicy() {
+	}
+
+	public ExpirationPolicyEnum getType() {
+		return type;
+	}
+	
+	public void setType(ExpirationPolicyEnum type) {
+		this.type = type;
+	}
+	
+	public int getOrganizationId() {
+		return organizationId;
+	}
+
+	public void setOrganizationId(int organizationId) {
+		this.organizationId = organizationId;
+	}
+	
+	public Date getReferenceDate() {
+		return referenceDate;
+	}
+	
+	public void setReferenceDate(Date referenceDate) {
+		this.referenceDate = referenceDate;
+	}
+	
+	public Integer getFrequency() {
+		return frequency;
+	}
+	
+	public void setFrequency(Integer frequency) {
+		this.frequency = frequency;
+	}
+	
+	public Boolean getResetNewUserPassword() {
+		return resetNewUserPassword;
+	}
+	
+	public void setResetNewUserPassword(Boolean resetNewUserPassword) {
+		this.resetNewUserPassword = resetNewUserPassword;
+	}
+}
Index: src/main/java/org/sigmah/client/page/admin/management/AdminPasswordExpirationPolicyManagementPresenter.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminPasswordExpirationPolicyManagementPresenter.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminPasswordExpirationPolicyManagementPresenter.java	(working copy)
@@ -0,0 +1,144 @@
+package org.sigmah.client.page.admin.management;
+
+import org.sigmah.client.cache.UserLocalCache;
+import org.sigmah.client.dispatch.Dispatcher;
+import org.sigmah.client.i18n.I18N;
+import org.sigmah.client.page.admin.management.AdminManagementPresenter.AdminManagementSubPresenter;
+import org.sigmah.client.util.Notification;
+import org.sigmah.shared.command.GetPasswordExpirationPolicy;
+import org.sigmah.shared.command.UpdatePasswordExpirationPolicy;
+import org.sigmah.shared.command.result.VoidResult;
+import org.sigmah.shared.domain.password.ExpirationPolicyEnum;
+import org.sigmah.shared.dto.PasswordExpirationPolicyDTO;
+
+import com.extjs.gxt.ui.client.event.BaseEvent;
+import com.extjs.gxt.ui.client.event.ButtonEvent;
+import com.extjs.gxt.ui.client.event.Events;
+import com.extjs.gxt.ui.client.event.Listener;
+import com.extjs.gxt.ui.client.event.SelectionListener;
+import com.extjs.gxt.ui.client.widget.ContentPanel;
+import com.extjs.gxt.ui.client.widget.MessageBox;
+import com.extjs.gxt.ui.client.widget.button.Button;
+import com.extjs.gxt.ui.client.widget.form.CheckBox;
+import com.extjs.gxt.ui.client.widget.form.DateField;
+import com.extjs.gxt.ui.client.widget.form.NumberField;
+import com.extjs.gxt.ui.client.widget.form.SimpleComboBox;
+import com.google.gwt.user.client.rpc.AsyncCallback;
+import com.google.inject.Inject;
+
+/**
+ * Presenter of the password expiration policy settings page.
+ * 
+ * @author renatoaf
+ */
+public class AdminPasswordExpirationPolicyManagementPresenter implements AdminManagementSubPresenter {
+    public interface View {
+        ContentPanel getContentPanel();
+
+        SimpleComboBox&lt;ExpirationPolicyEnum&gt; getExpirationPolicyTypeCombo();
+
+        DateField getScheduledDateField();
+        
+        CheckBox getResetNewUserPasswordField();
+        
+        NumberField getFrequencyField();
+
+        Button getSaveButton();
+    }
+
+    private final View view;
+    private boolean valueChanged;
+
+    @Inject
+    public AdminPasswordExpirationPolicyManagementPresenter(final UserLocalCache cache, final View view, final Dispatcher dispatcher) {
+        this.view = view;
+
+        view.getSaveButton().addSelectionListener(new SelectionListener&lt;ButtonEvent&gt;() {
+            @Override
+            public void componentSelected(ButtonEvent ce) {
+                UpdatePasswordExpirationPolicy settings = new UpdatePasswordExpirationPolicy();
+                settings.setType(view.getExpirationPolicyTypeCombo().getSimpleValue());
+                settings.setOrganizationId(cache.getOrganizationCache().getOrganization().getId());
+                settings.setReferenceDate(view.getScheduledDateField().getValue());
+                settings.setResetNewUserPassword(view.getResetNewUserPasswordField().getValue());
+                settings.setFrequency(view.getFrequencyField().getValue() == null || view.getFrequencyField().getValue().intValue() &lt; 1 ? null : view.getFrequencyField().getValue().intValue());
+                
+                if ((view.getScheduledDateField().isVisible() &amp;&amp; settings.getReferenceDate() == null) || (view.getFrequencyField().isVisible() &amp;&amp; settings.getFrequency() == null)) {
+                	MessageBox.alert(I18N.CONSTANTS.error(),
+	                        I18N.CONSTANTS.formWindowFieldsUnfilledDetails(), null);
+                	return;
+                }
+                
+                dispatcher.execute(settings, null, new AsyncCallback&lt;VoidResult&gt;() {
+                    @Override
+                    public void onFailure(Throwable caught) {
+                    	MessageBox.alert(I18N.CONSTANTS.savePasswordExpirationPolicyConfiguration(),
+		                        I18N.MESSAGES.adminStandardCreationFailure(
+		                        		I18N.CONSTANTS.passwordExpirationPolicy()), null);
+                    }
+                    
+                    @Override
+                    public void onSuccess(VoidResult result) {
+                        valueChanged = false;
+                        Notification.show(I18N.CONSTANTS.passwordExpirationPolicySaveChangesNotificationTitle(),
+                            I18N.CONSTANTS.passwordExpirationPolicySaveChangesNotificationMessage());
+                    }
+                });
+            }
+        });
+
+        Listener&lt;BaseEvent&gt; valueChangedListener = new Listener&lt;BaseEvent&gt;() {
+            @Override
+            public void handleEvent(BaseEvent be) {
+                valueChanged = true;
+            }
+        };
+
+        view.getExpirationPolicyTypeCombo().addListener(Events.SelectionChange, valueChangedListener);
+        view.getScheduledDateField().addListener(Events.Change, valueChangedListener);
+        view.getFrequencyField().addListener(Events.Change, valueChangedListener);
+        view.getResetNewUserPasswordField().addListener(Events.Change, valueChangedListener);
+
+        final GetPasswordExpirationPolicy settingsCommand = new GetPasswordExpirationPolicy(cache.getOrganizationCache().getOrganization().getId());
+        dispatcher.execute(settingsCommand, null, new AsyncCallback&lt;PasswordExpirationPolicyDTO&gt;() {
+            @Override
+            public void onFailure(Throwable caught) {
+            	
+            }
+
+            @Override
+            public void onSuccess(PasswordExpirationPolicyDTO result) {
+            	view.getScheduledDateField().setValue(result.getReferenceDate());
+            	view.getExpirationPolicyTypeCombo().setSimpleValue(result.getType());
+            	view.getFrequencyField().setValue(result.getFrequency());
+            	view.getResetNewUserPasswordField().setValue(result.getResetNewUserPassword());
+                valueChanged = false;
+            }
+        });
+    }
+
+    @Override
+    public boolean hasValueChanged() {
+        return valueChanged;
+    }
+
+    @Override
+    public void forgetAllChangedValues() {
+        valueChanged = false;
+    }
+
+    @Override
+    public void setCurrentState() {
+
+    }
+
+    @Override
+    public ContentPanel getContentPanel() {
+        return view.getContentPanel();
+    }
+
+    @Override
+    public String getName() {
+        return I18N.CONSTANTS.passwordExpirationPolicy();
+    }
+}
Index: src/main/java/org/sigmah/shared/command/GetPasswordExpirationPolicy.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/command/GetPasswordExpirationPolicy.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/command/GetPasswordExpirationPolicy.java	(working copy)
@@ -0,0 +1,31 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.shared.command;
+
+import org.sigmah.shared.dto.PasswordExpirationPolicyDTO;
+
+/**
+ * @author renatoaf
+ */
+public class GetPasswordExpirationPolicy implements Command&lt;PasswordExpirationPolicyDTO&gt; {
+	private static final long serialVersionUID = 5367051796565604864L;
+
+	private int organizationId;
+
+	public GetPasswordExpirationPolicy() {
+	}
+
+	public GetPasswordExpirationPolicy(int organizationId) {
+		this.organizationId = organizationId;
+	}
+
+	public int getOrganizationId() {
+		return organizationId;
+	}
+
+	public void setOrganizationId(int organizationId) {
+		this.organizationId = organizationId;
+	}
+}
Index: src/main/java/org/sigmah/shared/exception/WrongPasswordException.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/exception/WrongPasswordException.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/exception/WrongPasswordException.java	(working copy)
@@ -0,0 +1,8 @@
+package org.sigmah.shared.exception;
+
+public class WrongPasswordException extends Exception {
+	private static final long serialVersionUID = -459505547637837269L;
+
+	public WrongPasswordException() {
+	}
+}
Index: src/main/java/org/sigmah/server/policy/UserPolicy.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/policy/UserPolicy.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/policy/UserPolicy.java	(working copy)
@@ -98,8 +98,10 @@
                 userToPersist.setHashedPassword(PasswordHelper.hashPassword(password));
                 userToPersist.setChangePasswordKey(null);
                 userToPersist.setDateChangePasswordKeyIssued(new Date());
+            	userToPersist.setLastPasswordChange(new Date());
             } else if (userFound != null){
             	userToPersist.setHashedPassword(userFound.getHashedPassword());
+            	userToPersist.setLastPasswordChange(userFound.getLastPasswordChange());
             }
 
             if (userFound != null &amp;&amp; userFound.getId() &gt; 0) {
Index: src/main/java/org/sigmah/public/sigmah.css
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/public/sigmah.css	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/public/sigmah.css	(working copy)
@@ -88,7 +88,7 @@
 #logout {
 	font-size: 11px;
 	height: 16px;
-	width: 92px;
+	width: 80px;
 	float: right;
 	text-align: right;
 	padding-top: 1px;
@@ -123,8 +123,8 @@
 
 .minimenu {
 	height: 16px;
-	width: 245px;
-	float: right;
+	width: 280px;
+/*	float: right; */
 	text-align: right;
 	padding-top: 1px;
 	color: #C2C1C1;
Index: src/main/java/org/sigmah/shared/dto/UserDTO.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/dto/UserDTO.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/dto/UserDTO.java	(working copy)
@@ -87,6 +87,14 @@
     	set(&quot;pwdChangeDate&quot;, pwdChangeDate);
     }
     
+    public Date getLastPasswordChange() {
+        return get(&quot;lastPasswordChange&quot;);
+    }
+
+    public void setLastPasswordChange(Date passwordChange) {
+    	set(&quot;lastPasswordChange&quot;, passwordChange);
+    }
+    
     public List&lt;ProfileDTO&gt; getProfilesDTO() {
     	return get(&quot;profilesDTO&quot;);
     }
Index: src/main/java/org/sigmah/shared/domain/password/ExpirationPolicyEnum.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/password/ExpirationPolicyEnum.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/password/ExpirationPolicyEnum.java	(working copy)
@@ -0,0 +1,96 @@
+package org.sigmah.shared.domain.password;
+
+import java.util.Date;
+
+import org.sigmah.client.i18n.I18N;
+
+/**
+ * Enumeration for password expiration policies.
+ * 
+ * @author renatoaf
+ */
+public enum ExpirationPolicyEnum {
+	WEEKLY {
+		@Override
+		public boolean isExpired(PasswordExpirationPolicy policyContext, Date lastChange) {
+			Date currentDate = new Date();
+			return currentDate.getTime() - lastChange.getTime() &gt; ( WEEK * policyContext.getFrequency() );
+		}
+	},
+	
+	MONTHLY {
+		@Override
+		public boolean isExpired(PasswordExpirationPolicy policyContext, Date lastChange) {
+			Date currentDate = new Date();
+			return currentDate.getTime() - lastChange.getTime() &gt; ( MONTH * policyContext.getFrequency() );
+		}
+	},
+	
+	YEARLY {
+		@Override
+		public boolean isExpired(PasswordExpirationPolicy policyContext, Date lastChange) {
+			Date currentDate = new Date();
+			return currentDate.getTime() - lastChange.getTime() &gt; ( YEAR * policyContext.getFrequency() );
+		}
+	},
+	
+	SCHEDULED {
+		@Override
+		public boolean isExpired(PasswordExpirationPolicy policyContext, Date lastChange) {
+			return lastChange.before(policyContext.getReferenceDate());
+		}
+	},
+	
+	NEVER {
+		@Override
+		public boolean isExpired(PasswordExpirationPolicy policyContext, Date date) {
+			return false;
+		}
+	};
+
+	private static final long SECOND = 1000;
+	private static final long MINUTE = 60 * SECOND;
+	private static final long HOUR = 60 * MINUTE;
+	private static final long DAY = 24 * HOUR;
+	private static final long WEEK = 7 * DAY;
+	private static final long MONTH = 30 * DAY;
+	private static final long YEAR = 365 * DAY;
+	
+	public abstract boolean isExpired(PasswordExpirationPolicy policyContext, Date lastChange);
+	
+	public static String getName(ExpirationPolicyEnum policy) {
+		String policyName = null;
+		switch (policy) {
+		case WEEKLY:
+			policyName = I18N.CONSTANTS.weekly();
+			break;
+		case MONTHLY:
+			policyName = I18N.CONSTANTS.monthly();
+			break;
+		case YEARLY:
+			policyName = I18N.CONSTANTS.yearly();
+			break;
+		case NEVER:
+			policyName = I18N.CONSTANTS.never();
+			break;
+		case SCHEDULED:
+			policyName = I18N.CONSTANTS.scheduled();
+			break;
+		default:
+			policyName = &quot;default&quot;;
+		}
+		return policyName;
+	}
+	
+	public String toString() {
+		return getName(this);
+	}
+
+	public boolean requiresReferenceDate() {
+		return this == SCHEDULED;
+	}
+
+	public boolean requiresFrequency() {
+		return this == WEEKLY || this == MONTHLY || this == YEARLY;
+	}
+}
Index: src/main/java/org/sigmah/server/dao/PasswordExpirationPolicyDAO.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/dao/PasswordExpirationPolicyDAO.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/dao/PasswordExpirationPolicyDAO.java	(working copy)
@@ -0,0 +1,21 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.server.dao;
+
+import java.util.Date;
+
+import org.sigmah.shared.domain.password.ExpirationPolicyEnum;
+import org.sigmah.shared.domain.password.PasswordExpirationPolicy;
+
+/**
+ * DAO interface for password expiration policies.
+ * 
+ * @author renatoaf
+ */
+public interface PasswordExpirationPolicyDAO {
+	public PasswordExpirationPolicy getPasswordExpirationPolicyByOrganization(Integer id);
+
+	public void updateExpirationPolicy(Integer organizationId, ExpirationPolicyEnum expirationPolicyType, Date referenceDate, Integer frequency, Boolean resetNewUserPassword);
+}
Index: src/main/java/org/sigmah/client/page/admin/management/AdminBackupManagementPresenter.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminBackupManagementPresenter.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminBackupManagementPresenter.java	(working copy)
@@ -9,13 +9,13 @@
 import org.sigmah.client.page.admin.management.AdminManagementPresenter.AdminManagementSubPresenter;
 import org.sigmah.shared.dto.OrgUnitDTOLight;
 
+import com.extjs.gxt.ui.client.event.ButtonEvent;
+import com.extjs.gxt.ui.client.event.SelectionListener;
 import com.extjs.gxt.ui.client.widget.ContentPanel;
+import com.extjs.gxt.ui.client.widget.button.Button;
 import com.google.gwt.core.client.GWT;
-import com.google.gwt.event.dom.client.ClickEvent;
-import com.google.gwt.event.dom.client.ClickHandler;
 import com.google.gwt.user.client.Window;
 import com.google.gwt.user.client.rpc.AsyncCallback;
-import com.google.gwt.user.client.ui.Button;
 import com.google.gwt.user.client.ui.ListBox;
 import com.google.gwt.user.client.ui.RadioButton;
 import com.google.inject.ImplementedBy;
@@ -80,10 +80,10 @@
         
         view.getLastVersionRadioButton().setValue(true);
         
-        view.getBackupButton().addClickHandler(new ClickHandler() {
-            
+        view.getBackupButton().addSelectionListener(new SelectionListener&lt;ButtonEvent&gt;() {
+
             @Override
-            public void onClick(ClickEvent arg0) {
+            public void componentSelected(ButtonEvent ce) {
                 StringBuilder stringBuilder = new StringBuilder(GWT.getModuleBaseURL() + &quot;backup&quot;);
                 stringBuilder.append(&quot;?&quot;);
                 stringBuilder.append(&quot;downloadVersions&quot;).append(&quot;=&quot;).append(view.getAllVersionsRadioButton().getValue());
@@ -92,8 +92,8 @@
                 
                 Window.open(stringBuilder.toString(), &quot;_parent&quot;, &quot;location=no&quot;);
                 
-            }
-        });
+			}
+		});
     }
     
     
Index: src/main/java/org/sigmah/shared/dto/PasswordExpirationPolicyDTO.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/dto/PasswordExpirationPolicyDTO.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/dto/PasswordExpirationPolicyDTO.java	(working copy)
@@ -0,0 +1,65 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.shared.dto;
+
+import java.util.Date;
+
+import org.sigmah.shared.domain.password.ExpirationPolicyEnum;
+
+import com.extjs.gxt.ui.client.data.BaseModelData;
+
+/**
+ * @author renatoaf
+ */
+public class PasswordExpirationPolicyDTO extends BaseModelData implements EntityDTO {
+	private static final long serialVersionUID = -2053511704247237670L;
+
+	@Override
+	public int getId() {
+		final Integer id = (Integer) get(&quot;id&quot;);
+		return id != null ? id : -1;
+	}
+
+	public void setId(int id) {
+		set(&quot;id&quot;, id);
+	}
+	
+	public ExpirationPolicyEnum getType() {
+		return get(&quot;type&quot;);
+	}
+
+	public void setType(ExpirationPolicyEnum type) {
+		set(&quot;type&quot;, type);
+	} 
+
+    public Date getReferenceDate() {
+		return get(&quot;referenceDate&quot;);
+	}
+    
+    public void setReferenceDate(Date referenceDate) {
+    	set(&quot;referenceDate&quot;, referenceDate);
+	}
+    
+    public Integer getFrequency() {
+    	return get(&quot;frequency&quot;);
+    }
+    
+    public void setFrequency(Integer frequency) {
+    	set(&quot;frequency&quot;, frequency);
+    }
+    
+    public Boolean getResetNewUserPassword() {
+    	return get(&quot;resetNewUserPassword&quot;);
+    }
+    
+    public void setResetNewUserPassword(Boolean resetNewUserPassword) {
+    	set(&quot;resetNewUserPassword&quot;, resetNewUserPassword);
+    }
+
+	@Override
+	public String getEntityName() {
+		return &quot;PasswordExpirationPolicy&quot;;
+	}
+}
Index: src/main/java/org/sigmah/client/page/admin/management/AdminPasswordExpirationPolicyManagementView.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminPasswordExpirationPolicyManagementView.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminPasswordExpirationPolicyManagementView.java	(working copy)
@@ -0,0 +1,138 @@
+package org.sigmah.client.page.admin.management;
+
+import java.util.Arrays;
+import java.util.Date;
+
+import org.sigmah.client.i18n.I18N;
+import org.sigmah.client.page.admin.management.AdminPasswordExpirationPolicyManagementPresenter.View;
+import org.sigmah.shared.domain.password.ExpirationPolicyEnum;
+
+import com.extjs.gxt.ui.client.Style.HorizontalAlignment;
+import com.extjs.gxt.ui.client.event.SelectionChangedEvent;
+import com.extjs.gxt.ui.client.event.SelectionChangedListener;
+import com.extjs.gxt.ui.client.widget.ContentPanel;
+import com.extjs.gxt.ui.client.widget.button.Button;
+import com.extjs.gxt.ui.client.widget.form.ComboBox.TriggerAction;
+import com.extjs.gxt.ui.client.widget.form.CheckBox;
+import com.extjs.gxt.ui.client.widget.form.CheckBoxGroup;
+import com.extjs.gxt.ui.client.widget.form.DateField;
+import com.extjs.gxt.ui.client.widget.form.FormPanel;
+import com.extjs.gxt.ui.client.widget.form.NumberField;
+import com.extjs.gxt.ui.client.widget.form.SimpleComboBox;
+import com.extjs.gxt.ui.client.widget.form.SimpleComboValue;
+import com.extjs.gxt.ui.client.widget.layout.FormLayout;
+import com.google.inject.Inject;
+
+/**
+ * View for setting the password expiration policy.
+ * 
+ * @author renatoaf
+ */
+public class AdminPasswordExpirationPolicyManagementView extends ContentPanel implements View {
+    private final SimpleComboBox&lt;ExpirationPolicyEnum&gt; policyTypeCombo;
+    private final DateField scheduledDateField;
+    private final CheckBox resetNewUserPasswordField;
+    private final NumberField frequencyField;
+    private final Button saveButton;
+
+    @Inject
+	public AdminPasswordExpirationPolicyManagementView() {
+		this.setHeading(I18N.CONSTANTS.passwordExpirationPolicy());
+		
+		final FormPanel panel = new FormPanel();
+        panel.setHeaderVisible(false);
+        
+        FormLayout layout = new FormLayout();
+        layout.setLabelWidth(200);
+        panel.setLayout(layout);
+        
+        resetNewUserPasswordField = new CheckBox();
+
+        frequencyField = new NumberField();
+        frequencyField.setFieldLabel(I18N.CONSTANTS.frequency());
+        frequencyField.setAllowDecimals(false);
+        frequencyField.setAllowNegative(false);
+        frequencyField.setMinValue(1);
+        frequencyField.setAllowBlank(false);
+        
+        policyTypeCombo = new SimpleComboBox&lt;ExpirationPolicyEnum&gt;();
+        policyTypeCombo.add(Arrays.asList(ExpirationPolicyEnum.values()));
+        policyTypeCombo.setTriggerAction(TriggerAction.ALL);
+        policyTypeCombo.setEditable(false);
+        policyTypeCombo.setAllowBlank(false);
+        policyTypeCombo.setFieldLabel(I18N.CONSTANTS.expirationPolicy());
+        policyTypeCombo.addSelectionChangedListener(new SelectionChangedListener&lt;SimpleComboValue&lt;ExpirationPolicyEnum&gt;&gt;() {
+			public void selectionChanged(
+					SelectionChangedEvent&lt;SimpleComboValue&lt;ExpirationPolicyEnum&gt;&gt; se) {
+				SimpleComboValue&lt;ExpirationPolicyEnum&gt; selectedItem = se.getSelectedItem();
+				if (selectedItem != null) {
+					if (selectedItem.getValue().requiresReferenceDate()) {
+						scheduledDateField.setVisible(true);
+					} else {
+						scheduledDateField.clear();
+						scheduledDateField.setVisible(false);
+					}
+					
+					if (selectedItem.getValue().requiresFrequency()) {
+						frequencyField.setVisible(true);
+					} else {
+						frequencyField.clear();
+						frequencyField.setVisible(false);
+					}
+				}
+			}
+		});
+        
+        scheduledDateField = new DateField();
+        scheduledDateField.setFieldLabel(I18N.CONSTANTS.date());
+        scheduledDateField.setMinValue(new Date());
+        scheduledDateField.setAllowBlank(false);
+
+        saveButton = new Button(I18N.CONSTANTS.save());
+        
+        CheckBoxGroup resetNewUserPasswordCheckGroup = new CheckBoxGroup();
+        resetNewUserPasswordCheckGroup.setFieldLabel(I18N.CONSTANTS.resetNewUserPasswords());
+        resetNewUserPasswordCheckGroup.add(resetNewUserPasswordField);
+
+        panel.add(resetNewUserPasswordCheckGroup);
+        panel.add(policyTypeCombo);
+        panel.add(scheduledDateField);
+        panel.add(frequencyField);
+        panel.getButtonBar().add(saveButton);
+        panel.setButtonAlign(HorizontalAlignment.CENTER);
+        panel.getButtonBar().setEnableOverflow(false);
+        
+        this.setBodyStyleName(&quot;width-of-parent&quot;);
+        this.add(panel);
+    }
+
+    @Override
+    public ContentPanel getContentPanel() {
+        return this;
+    }
+
+    @Override
+    public SimpleComboBox&lt;ExpirationPolicyEnum&gt; getExpirationPolicyTypeCombo() {
+    	return policyTypeCombo;
+    }
+
+    @Override
+    public DateField getScheduledDateField() {
+		return scheduledDateField;
+	}
+
+    @Override
+    public NumberField getFrequencyField() {
+		return frequencyField;
+	}
+    
+    @Override
+    public CheckBox getResetNewUserPasswordField() {
+    	return resetNewUserPasswordField;
+    }
+ 
+    @Override
+    public Button getSaveButton() {
+        return saveButton;
+    }
+}
Index: src/main/java/org/sigmah/client/page/admin/management/AdminCoreManagementPresenter.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminCoreManagementPresenter.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminCoreManagementPresenter.java	(working copy)
@@ -10,15 +10,15 @@
 import org.sigmah.shared.dto.OrganizationDTO;
 import org.sigmah.shared.dto.value.FileUploadUtils;
 
+import com.extjs.gxt.ui.client.event.ButtonEvent;
+import com.extjs.gxt.ui.client.event.SelectionListener;
 import com.extjs.gxt.ui.client.widget.ContentPanel;
+import com.extjs.gxt.ui.client.widget.button.Button;
 import com.google.gwt.core.client.GWT;
 import com.google.gwt.event.dom.client.ChangeEvent;
 import com.google.gwt.event.dom.client.ChangeHandler;
-import com.google.gwt.event.dom.client.ClickEvent;
-import com.google.gwt.event.dom.client.ClickHandler;
 import com.google.gwt.user.client.Window;
 import com.google.gwt.user.client.rpc.AsyncCallback;
-import com.google.gwt.user.client.ui.Button;
 import com.google.gwt.user.client.ui.FileUpload;
 import com.google.gwt.user.client.ui.FormPanel;
 import com.google.gwt.user.client.ui.FormPanel.SubmitCompleteEvent;
@@ -115,10 +115,10 @@
             }
         });
 
-        view.getSaveButton().addClickHandler(new ClickHandler() {
-
-            @Override
-            public void onClick(ClickEvent event) {
+        view.getSaveButton().addSelectionListener(new SelectionListener&lt;ButtonEvent&gt;() {
+        	
+        	@Override
+			public void componentSelected(ButtonEvent ce) {
                 if (view.getOrganizationNameTextBox().getText().isEmpty()) {
                     Window.alert(I18N.CONSTANTS.organizationManagementBlankNameNotificationError());
                 } else {
Index: src/main/java/org/sigmah/client/page/admin/management/AdminCoreManagementView.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminCoreManagementView.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminCoreManagementView.java	(working copy)
@@ -4,8 +4,8 @@
 import org.sigmah.client.page.admin.management.AdminCoreManagementPresenter.View;
 
 import com.extjs.gxt.ui.client.widget.ContentPanel;
+import com.extjs.gxt.ui.client.widget.button.Button;
 import com.extjs.gxt.ui.client.widget.layout.FlowLayout;
-import com.google.gwt.user.client.ui.Button;
 import com.google.gwt.user.client.ui.FileUpload;
 import com.google.gwt.user.client.ui.FlexTable;
 import com.google.gwt.user.client.ui.FormPanel;
Index: src/main/java/org/sigmah/client/page/admin/management/AdminExportManagementView.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminExportManagementView.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/management/AdminExportManagementView.java	(working copy)
@@ -1,8 +1,5 @@
 package org.sigmah.client.page.admin.management;
 
-import java.util.HashMap;
-import java.util.Map;
-
 import org.sigmah.client.i18n.I18N;
 import org.sigmah.client.page.admin.management.AdminExportManagementPresenter.View;
 
Index: src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/UpdatePasswordExpirationPolicyHandler.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/UpdatePasswordExpirationPolicyHandler.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/UpdatePasswordExpirationPolicyHandler.java	(working copy)
@@ -0,0 +1,46 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.server.endpoint.gwtrpc.handler;
+
+import javax.persistence.EntityManager;
+
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+import org.dozer.Mapper;
+import org.sigmah.server.dao.PasswordExpirationPolicyDAO;
+import org.sigmah.shared.command.UpdatePasswordExpirationPolicy;
+import org.sigmah.shared.command.handler.CommandHandler;
+import org.sigmah.shared.command.result.CommandResult;
+import org.sigmah.shared.domain.User;
+import org.sigmah.shared.domain.password.PasswordExpirationPolicy;
+import org.sigmah.shared.exception.CommandException;
+
+import com.google.inject.Inject;
+
+/**
+ * Updates {@link PasswordExpirationPolicy} from a given update command.
+ * 
+ * @author renatoaf
+ */
+public class UpdatePasswordExpirationPolicyHandler implements CommandHandler&lt;UpdatePasswordExpirationPolicy&gt; {
+	protected static final Log log = LogFactory.getLog(UpdatePasswordExpirationPolicyHandler.class);
+	
+	protected final PasswordExpirationPolicyDAO dao;
+	protected final EntityManager em;
+	protected final Mapper mapper;
+
+	@Inject
+	public UpdatePasswordExpirationPolicyHandler(PasswordExpirationPolicyDAO dao, EntityManager em, Mapper mapper) {
+		this.dao = dao;
+		this.em = em;
+		this.mapper = mapper;
+	}
+			
+	@Override
+	public CommandResult execute(UpdatePasswordExpirationPolicy cmd, User user) throws CommandException {
+		dao.updateExpirationPolicy(cmd.getOrganizationId(), cmd.getType(), cmd.getReferenceDate(), cmd.getFrequency(), cmd.getResetNewUserPassword());
+		return null;
+	}
+}
Index: src/main/java/org/sigmah/shared/domain/User.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/User.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/User.java	(working copy)
@@ -5,11 +5,23 @@
 
 package org.sigmah.shared.domain;
 
-import org.sigmah.shared.domain.profile.OrgUnitProfile;
-
-import javax.persistence.*;
 import java.util.Date;
 
+import javax.persistence.Column;
+import javax.persistence.Entity;
+import javax.persistence.FetchType;
+import javax.persistence.GeneratedValue;
+import javax.persistence.GenerationType;
+import javax.persistence.Id;
+import javax.persistence.JoinColumn;
+import javax.persistence.ManyToOne;
+import javax.persistence.NamedQueries;
+import javax.persistence.NamedQuery;
+import javax.persistence.OneToOne;
+import javax.persistence.Table;
+
+import org.sigmah.shared.domain.profile.OrgUnitProfile;
+
 /**
  * Describes a user
  * 
@@ -35,6 +47,7 @@
     private String locale;
     private String changePasswordKey;
     private Date dateChangePasswordKeyIssued;
+    private Date lastPasswordChange;
     private String hashedPassword;
     private Organization organization;
     private OrgUnitProfile orgUnitWithProfiles;
@@ -153,6 +166,18 @@
         this.dateChangePasswordKeyIssued = dateChangePasswordKeyIssued;
     }
 
+    /**
+     * Gets the date on which the password was last changed.
+     */
+    @Column(name = &quot;last_password_change&quot;, nullable = true)
+    public Date getLastPasswordChange() {
+		return lastPasswordChange;
+	}
+    
+    public void setLastPasswordChange(Date lastPasswordChange) {
+		this.lastPasswordChange = lastPasswordChange;
+	}
+
     public void clearChangePasswordKey() {
         this.setChangePasswordKey(null);
         this.setDateChangePasswordKeyIssued(null);
Index: src/main/java/org/sigmah/server/dao/hibernate/PasswordExpirationPolicyHibernateDAO.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/dao/hibernate/PasswordExpirationPolicyHibernateDAO.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/dao/hibernate/PasswordExpirationPolicyHibernateDAO.java	(working copy)
@@ -0,0 +1,45 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.server.dao.hibernate;
+
+import java.util.Date;
+
+import javax.persistence.EntityManager;
+import javax.persistence.Query;
+
+import org.sigmah.server.dao.PasswordExpirationPolicyDAO;
+import org.sigmah.shared.domain.password.ExpirationPolicyEnum;
+import org.sigmah.shared.domain.password.PasswordExpirationPolicy;
+
+import com.google.inject.Inject;
+
+/**
+ * @author renatoaf
+ */
+public class PasswordExpirationPolicyHibernateDAO implements PasswordExpirationPolicyDAO {
+	private final EntityManager em;
+
+	@Inject
+	public PasswordExpirationPolicyHibernateDAO(EntityManager em) {
+		this.em = em;
+	}
+
+	@Override
+	public PasswordExpirationPolicy getPasswordExpirationPolicyByOrganization(Integer id) {
+		Query query = em.createQuery(&quot;FROM PasswordExpirationPolicy pep WHERE pep.organization.id = :id&quot;);
+		query.setParameter(&quot;id&quot;, id);
+		return (PasswordExpirationPolicy) query.getSingleResult();
+	}
+
+	@Override
+	public void updateExpirationPolicy(Integer organizationId, ExpirationPolicyEnum expirationPolicyType, Date referenceDate, Integer frequency, Boolean resetNewUserPassword) {
+		PasswordExpirationPolicy policy = getPasswordExpirationPolicyByOrganization(organizationId);
+		policy.setType(expirationPolicyType);
+		policy.setReferenceDate(referenceDate);
+		policy.setFrequency(frequency);
+		policy.setResetNewUserPassword(resetNewUserPassword);
+		em.merge(policy);
+	}
+}
Index: src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/GetPasswordExpirationPolicyHandler.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/GetPasswordExpirationPolicyHandler.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/endpoint/gwtrpc/handler/GetPasswordExpirationPolicyHandler.java	(working copy)
@@ -0,0 +1,48 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.server.endpoint.gwtrpc.handler;
+
+import javax.persistence.EntityManager;
+
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+import org.dozer.Mapper;
+import org.sigmah.server.dao.PasswordExpirationPolicyDAO;
+import org.sigmah.shared.command.GetPasswordExpirationPolicy;
+import org.sigmah.shared.command.handler.CommandHandler;
+import org.sigmah.shared.command.result.CommandResult;
+import org.sigmah.shared.domain.User;
+import org.sigmah.shared.domain.password.PasswordExpirationPolicy;
+import org.sigmah.shared.dto.PasswordExpirationPolicyDTO;
+import org.sigmah.shared.exception.CommandException;
+
+import com.google.inject.Inject;
+
+/**
+ * Provides {@link PasswordExpirationPolicy} for a given command.
+ * 
+ * @author renatoaf
+ */
+public class GetPasswordExpirationPolicyHandler implements CommandHandler&lt;GetPasswordExpirationPolicy&gt; {
+	protected static final Log log = LogFactory.getLog(GetPasswordExpirationPolicyHandler.class);
+
+	protected final PasswordExpirationPolicyDAO dao;
+	protected final EntityManager em;
+	protected final Mapper mapper;
+
+	@Inject
+	public GetPasswordExpirationPolicyHandler(PasswordExpirationPolicyDAO dao, EntityManager em, Mapper mapper) {
+		this.dao = dao;
+		this.em = em;
+		this.mapper = mapper;
+	}
+
+	@Override
+	public CommandResult execute(GetPasswordExpirationPolicy cmd, User user) throws CommandException {
+		PasswordExpirationPolicy policy = dao.getPasswordExpirationPolicyByOrganization(cmd .getOrganizationId());
+		PasswordExpirationPolicyDTO result = mapper.map(policy, PasswordExpirationPolicyDTO.class);
+		return result;
+	}
+}
Index: src/main/java/org/sigmah/client/page/admin/AdminModule.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/AdminModule.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/AdminModule.java	(working copy)
@@ -8,6 +8,8 @@
 import org.sigmah.client.page.admin.management.AdminExportManagementView;
 import org.sigmah.client.page.admin.management.AdminManagementPresenter;
 import org.sigmah.client.page.admin.management.AdminManagementView;
+import org.sigmah.client.page.admin.management.AdminPasswordExpirationPolicyManagementPresenter;
+import org.sigmah.client.page.admin.management.AdminPasswordExpirationPolicyManagementView;
 import org.sigmah.client.page.admin.model.common.AdminOneModelPresenter;
 import org.sigmah.client.page.admin.model.common.AdminOneModelView;
 
@@ -23,6 +25,7 @@
 		bind(AdminCoreManagementPresenter.View.class).to(AdminCoreManagementView.class);
 		bind(AdminBackupManagementPresenter.View.class).to(AdminBackupManagementView.class);
 		bind(AdminExportManagementPresenter.View.class).to(AdminExportManagementView.class);
+		bind(AdminPasswordExpirationPolicyManagementPresenter.View.class).to(AdminPasswordExpirationPolicyManagementView.class);
 	}
 
 }
Index: src/main/java/org/sigmah/shared/domain/profile/GlobalPermissionEnum.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/profile/GlobalPermissionEnum.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/profile/GlobalPermissionEnum.java	(working copy)
@@ -123,7 +123,12 @@
 	/**
 	 * Show global export button in projects list
 	 */
-	GLOBAL_EXPORT;
+	GLOBAL_EXPORT,
+
+	/**
+	 * for changing own password
+	 */
+	CHANGE_PASSWORD;
 
 	public static String getName(GlobalPermissionEnum gp) {
 		String gpName = &quot;default&quot;;
@@ -191,7 +196,9 @@
 		case GLOBAL_EXPORT:
 			gpName = I18N.CONSTANTS.globalExport();
 			break;
-
+		case CHANGE_PASSWORD:
+			gpName = I18N.CONSTANTS.CHANGE_OWN_PASSWORD();
+			break;
 		default:
 			gpName = null;
 		}
@@ -238,6 +245,9 @@
 		case GLOBAL_EXPORT:
 			gpCategory = I18N.CONSTANTS.categoryOthers();
 			break;
+		case CHANGE_PASSWORD:
+			gpCategory = I18N.CONSTANTS.categoryOthers();
+			break;
 		default:
 			break;
 		}
Index: src/main/java/org/sigmah/client/page/admin/users/AdminUsersView.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/users/AdminUsersView.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/page/admin/users/AdminUsersView.java	(working copy)
@@ -452,7 +452,7 @@
 		});
 		configs.add(column);
 
-		column = new ColumnConfig(&quot;pwdChangeDate&quot;, I18N.CONSTANTS.adminUsersDatePasswordChange(), 120);
+		column = new ColumnConfig(&quot;lastPasswordChange&quot;, I18N.CONSTANTS.adminUsersDatePasswordChange(), 120);
 		final DateTimeFormat format = DateUtils.DATE_SHORT;
 		column.setHeader(I18N.CONSTANTS.adminUsersDatePasswordChange());
 		column.setDateTimeFormat(format);
@@ -670,7 +670,7 @@
 	public ProfileSigmahForm showNewProfileForm(Window window, AsyncCallback&lt;CreateResult&gt; asyncCallback,
 	                ProfileDTO profileToUpdate) {
 		window.setHeading(I18N.CONSTANTS.adminProfileAdd());
-		window.setSize(550, 600);
+		window.setSize(550, 620);
 		window.setPlain(true);
 		window.setModal(true);
 		window.setBlinkModal(true);
Index: src/main/java/org/sigmah/server/dao/hibernate/HibernateModule.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/server/dao/hibernate/HibernateModule.java	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/server/dao/hibernate/HibernateModule.java	(working copy)
@@ -17,6 +17,7 @@
 import org.sigmah.server.dao.IndicatorDAO;
 import org.sigmah.server.dao.LocationDAO;
 import org.sigmah.server.dao.PartnerDAO;
+import org.sigmah.server.dao.PasswordExpirationPolicyDAO;
 import org.sigmah.server.dao.PersonalEventDAO;
 import org.sigmah.server.dao.ProjectReportDAO;
 import org.sigmah.server.dao.ReportDefinitionDAO;
@@ -98,6 +99,7 @@
         bind(PersonalEventDAO.class).to(PersonalEventHibernateDAO.class);
         bind(ProjectReportDAO.class).to(ProjectReportHibernateDAO.class);
         bind(GlobalExportDAO.class).to(GlobalExportHibernateDAO.class);
+        bind(PasswordExpirationPolicyDAO.class).to(PasswordExpirationPolicyHibernateDAO.class);
     }
 
     private &lt;T extends DAO&gt; void bindDAOProxy(Class&lt;T&gt; daoClass) {
Index: src/main/java/org/sigmah/shared/domain/password/PasswordExpirationPolicy.java
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/password/PasswordExpirationPolicy.java	(revision 0)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/shared/domain/password/PasswordExpirationPolicy.java	(working copy)
@@ -0,0 +1,100 @@
+/*
+ * All Sigmah code is released under the GNU General Public License v3
+ * See COPYRIGHT.txt and LICENSE.txt.
+ */
+package org.sigmah.shared.domain.password;
+
+import java.io.Serializable;
+import java.util.Date;
+
+import javax.persistence.Column;
+import javax.persistence.Entity;
+import javax.persistence.EnumType;
+import javax.persistence.Enumerated;
+import javax.persistence.GeneratedValue;
+import javax.persistence.GenerationType;
+import javax.persistence.Id;
+import javax.persistence.JoinColumn;
+import javax.persistence.ManyToOne;
+import javax.persistence.Table;
+
+import org.sigmah.shared.domain.Organization;
+
+/**
+ * Password expiration policy per organization.
+ * 
+ * @author renatoaf
+ */
+@Entity
+@Table(name = &quot;password_expiration_policy&quot;)
+public class PasswordExpirationPolicy implements Serializable {
+	private static final long serialVersionUID = -2722884637221828205L;
+
+	private Long id;
+	private ExpirationPolicyEnum type;
+	private Organization organization;
+	private Date referenceDate;
+	private Integer frequency;
+	private boolean resetNewUserPassword;
+	
+	@Column(name = &quot;policy_type&quot;, nullable = false)
+	@Enumerated(EnumType.STRING)
+	public ExpirationPolicyEnum getType() {
+		return type;
+	}
+
+	public void setType(ExpirationPolicyEnum type) {
+		this.type = type;
+	}
+
+	@Id
+	@GeneratedValue(strategy = GenerationType.AUTO)
+	public Long getId() {
+		return id;
+	}
+
+	public void setId(Long id) {
+		this.id = id;
+	}
+ 
+	@ManyToOne
+	@JoinColumn(name = &quot;organization_id&quot;, nullable = false)
+	public Organization getOrganization() {
+		return organization;
+	}
+
+	public void setOrganization(Organization organization) {
+		this.organization = organization;
+	}
+
+    @Column(name = &quot;reference_date&quot;, nullable = true)
+    public Date getReferenceDate() {
+		return referenceDate;
+	}
+    
+    public void setReferenceDate(Date referenceDate) {
+		this.referenceDate = referenceDate;
+	}
+
+    @Column(name = &quot;frequency&quot;, nullable = true)
+    public Integer getFrequency() {
+		return frequency;
+	}
+    
+    public void setFrequency(Integer frequency) {
+		this.frequency = frequency;
+	}
+
+    @Column(name = &quot;reset_for_new_users&quot;, nullable = true)
+    public boolean isResetNewUserPassword() {
+		return resetNewUserPassword;
+	}
+    
+    public void setResetNewUserPassword(boolean resetNewUserPassword) {
+		this.resetNewUserPassword = resetNewUserPassword;
+	}
+    
+	public boolean isExpired(Date lastPasswordChange) {
+		return getType().isExpired(this, lastPasswordChange);
+	}
+}
Index: src/main/java/org/sigmah/client/i18n/UIConstants.properties
===================================================================
--- workspace_dev/Sigmah/src/main/java/org/sigmah/client/i18n/UIConstants.properties	(revision 1560)
+++ workspace_dev/Sigmah/src/main/java/org/sigmah/client/i18n/UIConstants.properties	(working copy)
@@ -61,6 +61,8 @@
 
 EDIT_INDICATOR = Edit indicator
 
+CHANGE_OWN_PASSWORD = Change own password
+
 EDIT_OWN_REMINDERS = Edit own reminders
 
 EDIT_ALL_REMINDERS = Edit all reminders
@@ -2098,6 +2100,10 @@
 
 year = Year
 
+yearly = Yearly
+
+scheduled = Scheduled
+
 yes = Yes
 
 you = You
@@ -2388,4 +2394,26 @@
 #Name for permission not included in any catebory
 categoryNotMapped = Not in any Category
 
+#Label for the &quot;change own password&quot; option
+changePassword = Change your password
+
+#Text displayed when a user changes his password
+passwordChanged = Your password was successfully updated.
+
+#Labels displayed on password change prompt
+currentPassword = Current password
+wrongPassword = Wrong current password!
+illegalPasswordChange = Illegal operation: you should select a different password.
+
+#Labels displayed on password expiration policy configuration tab (administration)
+expirationPolicy = Expiration policy
+passwordExpirationPolicy = Password expiration policy
+
+resetNewUserPasswords = Ask new user to change his password
+frequency = Frequency
 
+savePasswordExpirationPolicyConfiguration = Password expiration policy configuration
+passwordExpirationPolicySaveChangesNotificationTitle = Changes saved
+passwordExpirationPolicySaveChangesNotificationMessage = Your changes are correctly saved !
+
+never = Never
\ No newline at end of file
</pre></span>
<br />
<a href="file_downloadb3e3.php?file_id=204&amp;type=bug"><img src="images/fileicons/generic.gif" alt="? file icon" width="16" height="16" border="0" /></a>&#160;<a href="file_downloadb3e3.php?file_id=204&amp;type=bug">438_scheme_updates_final.sql</a> [<a href="file_downloadb3e3.php?file_id=204&amp;type=bug" target="_blank">^</a>] (983 bytes) <span class="italic">2014-06-30 08:38</span></td></tr><tr align="center"><td align="center" colspan="6"><table><tr class="vcenter"><td class="center"></td><td class="center"></td><td class="center"></td><td class="center"></td></tr></table></td></tr></table><br />

<div id="relationships_open"><table class="width100" cellspacing="1">
<tr class="row-2" valign="top">
	<td width="15%" class="form-title" colspan="2">
		<a href="#" onclick="ToggleDiv( 'relationships' ); return false;"
			><img border="0" src="images/minus.html" alt="-" /></a>&#160;Relationships	</td>
</tr>
<tr>
	<td colspan="2"><table border="0" width="100%" cellpadding="0" cellspacing="1"><tr bgcolor="#c2dfff"><td><span class="nowrap">related to</span>&#160;</td><td><a href="view6017.html?id=517">0000517</a></td><td><span class="issue-status" title="open">assigned</span></td><td><span class="nowrap"><a href="view_user_page95dc.html?id=29">renatoaf</a></span>&#160;</td><td>Automatic user password reset&#160;</td></tr>
</table></td>
</tr>
</table>

</div><div id="relationships_closed" class="hidden"><table class="width100" cellspacing="1">
<tr>
	<td class="form-title">
		<a href="#" onclick="ToggleDiv( 'relationships' ); return false;"
			><img border="0" src="images/plus.html" alt="+" /></a>&#160;Relationships	</td>
</tr>
</table>

</div>
<a name="bugnotes" id="bugnotes" /><br />

<div id="bugnotes_open"><table class="width100" cellspacing="1">
<tr>
	<td class="form-title" colspan="2">
<a href="#" onclick="ToggleDiv( 'bugnotes' ); return false;"
			><img border="0" src="images/minus.html" alt="-" /></a>&#160;		Notes	</td>
</tr>
<tr class="bugnote" id="c1415">
        <td class="bugnote-public">
				<span class="small">(<a href="view0fbe.html?id=438#c1415" title="Direct link to note">0001415)</a></span><br />
		<a href="view_user_page95dc.html?id=29">renatoaf</a>		<span class="small">(developer)</span>
				<br />
		<span class="small">2014-05-27 06:05</span><br />
				<br /><div class="small">
				</div>
	</td>
	<td class="bugnote-note-public">
		Hi, I've uploaded some pictures to illustrate the solution behavior. Some comments:<br />
<br />
- The button &quot;Change your password&quot; (picture 2) only appears when the user has the permission &quot;Change own password&quot;, granted by his profiles (picture 1). By clicking on it, he will be able to change his password whenever he wants (picture 3);<br />
<br />
- The &quot;Change password&quot; prompt (picture 3) also shows up automatically when a new user logs in or when his password expires (which is defined according to the last time the user changed his password and  the expiration policy configured by an administrator);<br />
<br />
- Five expiration policies are available: Never, Weekly, Monthly, Yearly and Scheduled (pictures 4 and 5). The &quot;Scheduled&quot; expiration policy requires a specific date on which all users should change their password. I believe the others are self-explainable.<br />
<br />
One important question:<br />
<br />
- Users are allowed to use their current password when the &quot;change password&quot; prompt shows up automatically? (i. e. they can choose not to update it?)<br />
<br />
Please let me know if anything should be changed or improved.	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote" id="c1416">
        <td class="bugnote-public">
				<span class="small">(<a href="view0fbe.html?id=438#c1416" title="Direct link to note">0001416)</a></span><br />
		<a href="view_user_page0b30.html?id=2">osarrat</a>		<span class="small">(administrator)</span>
				<br />
		<span class="small">2014-06-02 20:54</span><br />
				<br /><div class="small">
				</div>
	</td>
	<td class="bugnote-note-public">
		Very good work so far! (on the basis of the screenshots)<br />
I like very much your idea to have the &quot;Change password&quot; link closed to the logout button.<br />
<br />
My replies and suggestions for last improvements:<br />
- When the &quot;Change password&quot; prompt shows up automatically, users are not allowed to set up a new password which is the same as the current one.<br />
- The &quot;Change password&quot; prompt should pop up automatically only when the user password has expired and he logs in. There is no reason to ask a new user to change his password automatically at his first log in. (which reason whould you see?)<br />
- For security reason, when the &quot;Change password&quot; prompt is opened manually, the system should also ask the current password for verification.<br />
- For the expiration policies, I would suggest to have: Never, Weeks, Months, Scheduled. If Weeks or Months is selected, the admin must enter a number (positive integer) indicating the number of weeks or months to use as frequency. I'm sure some organisation may request to have changes every 3 months or 6 months...<br />
<br />
Congrats for the good design!	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote" id="c1417">
        <td class="bugnote-public">
				<span class="small">(<a href="view0fbe.html?id=438#c1417" title="Direct link to note">0001417)</a></span><br />
		<a href="view_user_page95dc.html?id=29">renatoaf</a>		<span class="small">(developer)</span>
				<br />
		<span class="small">2014-06-04 22:03</span><br />
				<br /><div class="small">
				</div>
	</td>
	<td class="bugnote-note-public">
		Hi osarrat,<br />
<br />
I like these ideas too. I'll work on these improvements soon.<br />
<br />
As for the second topic: &quot;There is no reason to ask a new user to change his password automatically at his first log in. (which reason whould you see?)&quot;, I based it on the feature description:<br />
<br />
&quot;... he will be prompted to change his password by himself each time his password has been automatically set or reset (at the creation of his user account, or when his password has expired)&quot;<br />
<br />
I thought it was required because user's first password is currently automatically defined ( sent within the email invitation ). Is this no longer necessary?<br />
<br />
Thank you for the feedback.	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote" id="c1419">
        <td class="bugnote-public">
				<span class="small">(<a href="view0fbe.html?id=438#c1419" title="Direct link to note">0001419)</a></span><br />
		<a href="view_user_page0b30.html?id=2">osarrat</a>		<span class="small">(administrator)</span>
				<br />
		<span class="small">2014-06-06 14:39</span><br />
				<br /><div class="small">
				</div>
	</td>
	<td class="bugnote-note-public">
		I haven't read again the initial description of the feature.<br />
I think then that the behaviof you planned is right, but I would suggest to make this feature flexibility: a new &quot;Ask user for new password at his first log in&quot; checkbox in the &quot;Password expiration policy&quot; admin part could be added.<br />
If you are ok with it, let's go in that direction!	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote" id="c1421">
        <td class="bugnote-public">
				<span class="small">(<a href="view0fbe.html?id=438#c1421" title="Direct link to note">0001421)</a></span><br />
		<a href="view_user_page95dc.html?id=29">renatoaf</a>		<span class="small">(developer)</span>
				<br />
		<span class="small">2014-06-08 07:30</span><br />
				<br /><div class="small">
				</div>
	</td>
	<td class="bugnote-note-public">
		Great! I'll get back to it as soon as I finish a first version of <a href="viewcd66.html?id=419" title="[closed] Project/orgunit models modifications with Available status" class="resolved">0000419</a>.<br />
Thank you.	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote" id="c1456">
        <td class="bugnote-public">
				<span class="small">(<a href="view0fbe.html?id=438#c1456" title="Direct link to note">0001456)</a></span><br />
		<a href="view_user_page95dc.html?id=29">renatoaf</a>		<span class="small">(developer)</span>
				<br />
		<span class="small">2014-06-30 08:39</span><br />
				<br /><div class="small">
				</div>
	</td>
	<td class="bugnote-note-public">
		I just attached a new patch and SQL script with all adjustments. Please ignore the first patch I've sent.	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote" id="c1489">
        <td class="bugnote-public">
				<span class="small">(<a href="view0fbe.html?id=438#c1489" title="Direct link to note">0001489)</a></span><br />
		<a href="view_user_page95dc.html?id=29">renatoaf</a>		<span class="small">(developer)</span>
				<br />
		<span class="small">2014-08-10 22:06</span><br />
				<br /><div class="small">
				</div>
	</td>
	<td class="bugnote-note-public">
		I've merged all my GSoC work into a single patch to simplify the synchronization, so please ignore this patch. I'll update the wiki page with the SQL modifications.	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote" id="c1495">
        <td class="bugnote-public">
				<span class="small">(<a href="view0fbe.html?id=438#c1495" title="Direct link to note">0001495)</a></span><br />
		<a href="view_user_page0b30.html?id=2">osarrat</a>		<span class="small">(administrator)</span>
				<br />
		<span class="small">2014-08-13 15:54</span><br />
				<br /><div class="small">
				</div>
	</td>
	<td class="bugnote-note-public">
		When you will upload your patch, please indicate then all the issues it should solve (and don't forget to include issue <a href="view6017.html?id=517" title="[assigned] Automatic user password reset">0000517</a> in the list).	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote" id="c1510">
        <td class="bugnote-public">
				<span class="small">(<a href="view0fbe.html?id=438#c1510" title="Direct link to note">0001510)</a></span><br />
		<a href="view_user_page0b30.html?id=2">osarrat</a>		<span class="small">(administrator)</span>
				<br />
		<span class="small">2014-12-12 10:16</span><br />
				<br /><div class="small">
				</div>
	</td>
	<td class="bugnote-note-public">
		Latest patch to fix this issue attached as a larger patch on issue <a href="viewcd66.html?id=419" title="[closed] Project/orgunit models modifications with Available status" class="resolved">0000419</a>.	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote" id="c1572">
        <td class="bugnote-public">
				<span class="small">(<a href="view0fbe.html?id=438#c1572" title="Direct link to note">0001572)</a></span><br />
		<a href="view_user_page0b30.html?id=2">osarrat</a>		<span class="small">(administrator)</span>
				<br />
		<span class="small">2015-04-03 16:59</span><br />
				<br /><div class="small">
				</div>
	</td>
	<td class="bugnote-note-public">
		Issue closed because general expected behavior checked on v2.0-rc1.	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote" id="c1573">
        <td class="bugnote-public">
				<span class="small">(<a href="view0fbe.html?id=438#c1573" title="Direct link to note">0001573)</a></span><br />
		<a href="view_user_page0b30.html?id=2">osarrat</a>		<span class="small">(administrator)</span>
				<br />
		<span class="small">2015-04-03 17:17</span><br />
				<br /><div class="small">
				</div>
	</td>
	<td class="bugnote-note-public">
		Issue completly verified through test case app-178 .	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
</table>

</div><div id="bugnotes_closed" class="hidden">
<table class="width100" cellspacing="1">
<tr>
	<td class="form-title" colspan="2">
		<a href="#" onclick="ToggleDiv( 'bugnotes' ); return false;"
			><img border="0" src="images/plus.html" alt="+" /></a>&#160;		Notes	</td>
</tr>
</table>
</div><div id="Source_open"><br/>
<a name="changesets"/>
<table class="width100" cellspacing="1">

<tr>
	<td class="form-title"><a href="#" onclick="ToggleDiv( 'Source' ); return false;"
			><img border="0" src="images/minus.html" alt="-" /></a>&#160;Related Changesets</td>
</tr>
		
<tr class="row-1">
<td class="category" width="25%" rowspan="12">
	<a name="changeset1741">sigmah: master 774e8221</a>
	<br/><span class="small">Timestamp: 2015-03-12 18:32:44</span>
	<br/><span class="small">Author: daeke</span>
			<br/><span class="small">Ported: N/A</span>
		<br/><span class="small-links">
		<span class="bracket-link">[&#160;<a href="plugina612.php?page=Source/view&amp;id=1741">Details</a>&#160;]</span> <span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/commit/774e8221730be286cd0bb031caf6828149263951">Diff</a>&#160;]</span> </td>
<td colspan="3">Possibility for a user to change its own password (issue <a href="view0fbe.html?id=438" title="[closed] Own password modification by user" class="resolved">0000438</a>).</td>
</tr>

		<tr class="row-2">
<td class="small mono" colspan="2">mod - src/main/java/org/sigmah/client/Sigmah.java</td>
<td class="center" width="12%"><span class="small-links">
		<span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/commit/774e8221730be286cd0bb031caf6828149263951">Diff</a>&#160;]</span> <span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/tree/774e8221730be286cd0bb031caf6828149263951/src/main/java/org/sigmah/client/Sigmah.java">File</a>&#160;]</span> </span></td>
</tr>
		<tr class="row-2">
<td class="small mono" colspan="2">mod - src/main/java/org/sigmah/client/inject/Injector.java</td>
<td class="center" width="12%"><span class="small-links">
		<span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/commit/774e8221730be286cd0bb031caf6828149263951">Diff</a>&#160;]</span> <span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/tree/774e8221730be286cd0bb031caf6828149263951/src/main/java/org/sigmah/client/inject/Injector.java">File</a>&#160;]</span> </span></td>
</tr>
		<tr class="row-2">
<td class="small mono" colspan="2">mod - src/main/java/org/sigmah/client/page/Page.java</td>
<td class="center" width="12%"><span class="small-links">
		<span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/commit/774e8221730be286cd0bb031caf6828149263951">Diff</a>&#160;]</span> <span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/tree/774e8221730be286cd0bb031caf6828149263951/src/main/java/org/sigmah/client/page/Page.java">File</a>&#160;]</span> </span></td>
</tr>
		<tr class="row-2">
<td class="small mono" colspan="2">add - src/main/java/org/sigmah/client/ui/presenter/password/ChangeOwnPasswordPresenter.java</td>
<td class="center" width="12%"><span class="small-links">
		<span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/commit/774e8221730be286cd0bb031caf6828149263951">Diff</a>&#160;]</span> <span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/tree/774e8221730be286cd0bb031caf6828149263951/src/main/java/org/sigmah/client/ui/presenter/password/ChangeOwnPasswordPresenter.java">File</a>&#160;]</span> </span></td>
</tr>
		<tr class="row-2">
<td class="small mono" colspan="2">mod - src/main/java/org/sigmah/client/ui/presenter/zone/AuthenticationBannerPresenter.java</td>
<td class="center" width="12%"><span class="small-links">
		<span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/commit/774e8221730be286cd0bb031caf6828149263951">Diff</a>&#160;]</span> <span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/tree/774e8221730be286cd0bb031caf6828149263951/src/main/java/org/sigmah/client/ui/presenter/zone/AuthenticationBannerPresenter.java">File</a>&#160;]</span> </span></td>
</tr>
		<tr class="row-2">
<td class="small mono" colspan="2">add - src/main/java/org/sigmah/client/ui/view/password/ChangeOwnPasswordView.java</td>
<td class="center" width="12%"><span class="small-links">
		<span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/commit/774e8221730be286cd0bb031caf6828149263951">Diff</a>&#160;]</span> <span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/tree/774e8221730be286cd0bb031caf6828149263951/src/main/java/org/sigmah/client/ui/view/password/ChangeOwnPasswordView.java">File</a>&#160;]</span> </span></td>
</tr>
		<tr class="row-2">
<td class="small mono" colspan="2">mod - src/main/java/org/sigmah/client/ui/view/zone/AuthenticationBannerView.java</td>
<td class="center" width="12%"><span class="small-links">
		<span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/commit/774e8221730be286cd0bb031caf6828149263951">Diff</a>&#160;]</span> <span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/tree/774e8221730be286cd0bb031caf6828149263951/src/main/java/org/sigmah/client/ui/view/zone/AuthenticationBannerView.java">File</a>&#160;]</span> </span></td>
</tr>
		<tr class="row-2">
<td class="small mono" colspan="2">mod - src/main/java/org/sigmah/server/domain/User.java</td>
<td class="center" width="12%"><span class="small-links">
		<span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/commit/774e8221730be286cd0bb031caf6828149263951">Diff</a>&#160;]</span> <span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/tree/774e8221730be286cd0bb031caf6828149263951/src/main/java/org/sigmah/server/domain/User.java">File</a>&#160;]</span> </span></td>
</tr>
		<tr class="row-2">
<td class="small mono" colspan="2">add - src/main/java/org/sigmah/server/handler/ChangePasswordCommandHandler.java</td>
<td class="center" width="12%"><span class="small-links">
		<span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/commit/774e8221730be286cd0bb031caf6828149263951">Diff</a>&#160;]</span> <span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/tree/774e8221730be286cd0bb031caf6828149263951/src/main/java/org/sigmah/server/handler/ChangePasswordCommandHandler.java">File</a>&#160;]</span> </span></td>
</tr>
		<tr class="row-2">
<td class="small mono" colspan="2">mod - src/main/java/org/sigmah/server/inject/CommandHandlerModule.java</td>
<td class="center" width="12%"><span class="small-links">
		<span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/commit/774e8221730be286cd0bb031caf6828149263951">Diff</a>&#160;]</span> <span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/tree/774e8221730be286cd0bb031caf6828149263951/src/main/java/org/sigmah/server/inject/CommandHandlerModule.java">File</a>&#160;]</span> </span></td>
</tr>
		<tr class="row-2">
<td class="small mono" colspan="2">add - src/main/java/org/sigmah/shared/command/ChangePasswordCommand.java</td>
<td class="center" width="12%"><span class="small-links">
		<span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/commit/774e8221730be286cd0bb031caf6828149263951">Diff</a>&#160;]</span> <span class="bracket-link">[&#160;<a href="http://github.com/sigmah-dev/sigmah/tree/774e8221730be286cd0bb031caf6828149263951/src/main/java/org/sigmah/shared/command/ChangePasswordCommand.java">File</a>&#160;]</span> </span></td>
</tr>
		<tr><td class="spacer"></td></tr>
		</table>
</div><div id="Source_closed" class="hidden"><br/>
<table class="width100" cellspacing="1">

<tr>
	<td class="form-title"><a href="#" onclick="ToggleDiv( 'Source' ); return false;"
			><img border="0" src="images/plus.html" alt="+" /></a>&#160;Related Changesets</td>
</tr>

</table>
</div>
<a name="history" id="history" /><br />

<div id="history_open"><table class="width100" cellspacing="0">
<tr>
	<td class="form-title" colspan="4">
<a href="#" onclick="ToggleDiv( 'history' ); return false;"
			><img border="0" src="images/minus.html" alt="-" /></a>&#160;Issue History	</td>
</tr>
<tr class="row-category-history">
	<td class="small-caption">
		Date Modified	</td>
	<td class="small-caption">
		Username	</td>
	<td class="small-caption">
		Field	</td>
	<td class="small-caption">
		Change	</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2012-02-02 13:00	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		New Issue	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2012-12-04 14:40	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Description Updated	</td>
	<td class="small-caption">
		<a href="bug_revision_view_page2825.php?rev_id=302#r302">View Revisions</a>	</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2013-02-25 13:29	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		OS	</td>
	<td class="small-caption">
		Windows Vista =&gt; NA	</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2013-02-25 13:29	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Browser	</td>
	<td class="small-caption">
		Mozilla Firefox 9.0 =&gt; NA	</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2013-02-25 13:29	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Target Version	</td>
	<td class="small-caption">
		unplanned =&gt; 3.0	</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2013-02-25 13:29	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Description Updated	</td>
	<td class="small-caption">
		<a href="bug_revision_view_page824f.php?rev_id=320#r320">View Revisions</a>	</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2013-02-26 15:25	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Tag Attached: Enhanced user session management	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2013-02-26 15:30	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Tag Renamed	</td>
	<td class="small-caption">
		Enhanced user session management =&gt; Enhanced user session and rights	</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2014-05-24 00:03	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		Assigned To	</td>
	<td class="small-caption">
		 =&gt; renatoaf	</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2014-05-24 00:03	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		Status	</td>
	<td class="small-caption">
		new =&gt; assigned	</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2014-05-27 05:40	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		File Added: 01.permission.png	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2014-05-27 05:40	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		File Added: 02.change_password_option.png	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2014-05-27 05:40	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		File Added: 03.change_password_prompt.png	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2014-05-27 05:40	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		File Added: 04.expiration_policy_1.png	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2014-05-27 05:41	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		File Added: 05.expiration_policy_2.png	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2014-05-27 05:43	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		File Added: 438_patch.txt	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2014-05-27 05:44	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		File Added: 438_scheme_updates.sql	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2014-05-27 06:05	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		Note Added: 0001415	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2014-06-02 20:54	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Note Added: 0001416	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2014-06-04 22:03	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		Note Added: 0001417	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2014-06-06 14:39	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Note Added: 0001419	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2014-06-08 07:30	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		Note Added: 0001421	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2014-06-30 08:36	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		File Added: fix01 - frequency and new user policy.png	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2014-06-30 08:37	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		File Added: fix02 - current password.png	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2014-06-30 08:37	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		File Added: 438_patch_v2.txt	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2014-06-30 08:38	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		File Added: 438_scheme_updates_final.sql	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2014-06-30 08:39	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		Note Added: 0001456	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2014-08-10 22:06	</td>
	<td class="small-caption">
		<a href="view_user_page95dc.html?id=29">renatoaf</a>	</td>
	<td class="small-caption">
		Note Added: 0001489	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2014-08-13 15:51	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Relationship added	</td>
	<td class="small-caption">
		parent of 0000517	</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2014-08-13 15:52	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Target Version	</td>
	<td class="small-caption">
		3.0 =&gt; 2.0	</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2014-08-13 15:52	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Description Updated	</td>
	<td class="small-caption">
		<a href="bug_revision_view_page153e.php?rev_id=471#r471">View Revisions</a>	</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2014-08-13 15:54	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Note Added: 0001495	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2014-12-12 10:16	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Note Added: 0001510	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2015-03-12 19:00	</td>
	<td class="small-caption">
			</td>
	<td class="small-caption">
		Changeset attached	</td>
	<td class="small-caption">
		 =&gt; sigmah master 774e8221	</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2015-04-03 16:57	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Relationship replaced	</td>
	<td class="small-caption">
		related to 0000517	</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2015-04-03 16:59	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Note Added: 0001572	</td>
	<td class="small-caption">
			</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2015-04-03 16:59	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Status	</td>
	<td class="small-caption">
		assigned =&gt; closed	</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2015-04-03 16:59	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Resolution	</td>
	<td class="small-caption">
		open =&gt; fixed	</td>
</tr>
<tr class="row-2">
	<td class="small-caption">
		2015-04-03 16:59	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Fixed in Version	</td>
	<td class="small-caption">
		 =&gt; 2.0	</td>
</tr>
<tr class="row-1">
	<td class="small-caption">
		2015-04-03 17:17	</td>
	<td class="small-caption">
		<a href="view_user_page0b30.html?id=2">osarrat</a>	</td>
	<td class="small-caption">
		Note Added: 0001573	</td>
	<td class="small-caption">
			</td>
</tr>
</table>
</div><div id="history_closed" class="hidden"><table class="width100" cellspacing="0">
<tr>
	<td class="form-title" colspan="4">
	<a href="#" onclick="ToggleDiv( 'history' ); return false;"
			><img border="0" src="images/plus.html" alt="+" /></a>&#160;Issue History	</td>
</tr>
</table>

</div>	<br />
	<hr size="1" />
<table border="0" width="100%" cellspacing="0" cellpadding="0"><tr valign="top"><td>	<address>Copyright &copy; 2000 - 2018 MantisBT Team</address>
</td><td>
	<div align="right"><a href="http://www.mantisbt.org/" title="Free Web Based Bug Tracker"><img src="images/mantis_logo.html" width="145" height="50" alt="Powered by Mantis Bugtracker" border="0" /></a></div>
</td></tr></table>
</body>

<!-- Mirrored from www.sigmah.org/issues/view.php?id=438&history=1 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 25 Jul 2018 16:11:42 GMT -->
</html>
