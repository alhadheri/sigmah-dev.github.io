<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>

<!-- Mirrored from www.sigmah.org/issues/print_bug_page.php?bug_id=963 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 25 Jul 2018 15:47:59 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
	<link rel="stylesheet" type="text/css" href="css/default.html" />
	<script type="text/javascript"><!--
		if(document.layers) {document.write("<style>td{padding:0px;}<\/style>")}
	// --></script>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Cache-Control" content="no-cache" />
	<meta http-equiv="Pragma-directive" content="no-cache" />
	<meta http-equiv="Cache-Directive" content="no-cache" />
	<meta http-equiv="Expires" content="Wed, 25 Jul 2018 15:14:22 GMT" />
	<link rel="shortcut icon" href="images/favicon.html" type="image/x-icon" />
	<link rel="search" type="application/opensearchdescription+xml" title="MantisBT: Text Search" href="browser_search_plugin84ae.html?type=text" />	<link rel="search" type="application/opensearchdescription+xml" title="MantisBT: Issue Id" href="browser_search_pluginb70d.html?type=id" />	<title>0000963: Impossible to delete custom choice on under maintenance orgunit model - Sigmah Issue Tracker</title>
<script type="text/javascript" src="javascript/min/common.html"></script>
<script type="text/javascript">var loading_lang = "Loading...";</script><script type="text/javascript" src="javascript/min/ajax.js"></script>
<link rel="stylesheet" type="text/css" href="plugin_filea93c.css?file=Source/style.css"/></head>
<body>
<br /><table class="width100" cellspacing="1"><tr><td class="form-title" colspan="6"><div class="center">Sigmah Issue Tracker - sigmah</div></td></tr><tr><td class="form-title" colspan="6">View Issue Details</td></tr><tr><td class="print-spacer" colspan="6"><hr size="1" /></td></tr><tr class="print-category"><td class="print" width="16%">ID</td><td class="print" width="16%">Project</td><td class="print" width="16%">Category</td><td class="print" width="16%">View Status</td><td class="print" width="16%">Date Submitted</td><td class="print" width="16%">Last Update</td></tr><tr class="print"><td class="print">0000963</td><td class="print">sigmah</td><td class="print">Administration</td><td class="print">public</td><td class="print">2016-09-28 10:59</td><td class="print">2016-12-14 11:13</td></tr><tr><td class="print-spacer" colspan="6"><hr size="1" /></td></tr><tr class="print"><td class="print-category">Reporter</td><td class="print">assisturd</td><td class="print" colspan="4">&#160;</td></tr><tr class="print"><td class="print-category">Assigned To</td><td class="print"></td><td class="print" colspan="4">&#160;</td></tr><tr class="print"><td class="print-category">Priority</td><td class="print">low</td><td class="print-category">Severity</td><td class="print">major</td><td class="print-category">Reproducibility</td><td class="print">always</td></tr><tr class="print"><td class="print-category">Status</td><td class="print">new</td><td class="print-category">Resolution</td><td class="print">open</td><td class="print" colspan="2">&#160;</td></tr><tr class="print"><td class="print-category">Platform</td><td class="print"></td><td class="print-category">OS</td><td class="print"></td><td class="print-category">OS Version</td><td class="print"></td></tr><tr class="print"><td class="print-category">Product Version</td><td class="print">2.1</td><td class="print" colspan="4">&#160;</td></tr><tr><td class="print-category">Target Version</td><td class="print">next-but-one</td><td class="print-category">Fixed in Version</td><td class="print"></td><td class="print" colspan="2">&#160;</td></tr><tr class="print"><td class="print-category">User Report URL</td><td class="print" colspan="4"></td></tr><tr class="print"><td class="print-category">OS</td><td class="print" colspan="4">NA</td></tr><tr class="print"><td class="print-category">Other OS</td><td class="print" colspan="4"></td></tr><tr class="print"><td class="print-category">Browser</td><td class="print" colspan="4">NA</td></tr><tr class="print"><td class="print-category">Other browser</td><td class="print" colspan="4"></td></tr><tr class="print"><td class="print-category">ScreenURL</td><td class="print" colspan="4"></td></tr><tr class="print"><td class="print-category">(ActivityInfo) Noticed in revision</td><td class="print" colspan="4"></td></tr><tr><td class="print-spacer" colspan="6"><hr size="1" /></td></tr><tr class="print"><td class="print-category">Summary</td><td class="print" colspan="5">0000963: Impossible to delete custom choice on under maintenance orgunit model</td></tr><tr class="print"><td class="print-category">Description</td><td class="print" colspan="5">On v2.2 rc1, Test Case app-190 : &quot;Add or disable a choice in a list of choice field in an available orgunit models&quot;<br />
<br />
See &quot;Steps to reproduce&quot; below.</td></tr><tr class="print"><td class="print-category">Steps To Reproduce</td><td class="print" colspan="5">1. In the orgunits models dashboard, click on an orgunits with the &quot;available and use models&quot;. <br />
2. Make it under maintenance (and don't change the default earliest later maintenance starting time). <br />
3. Create a new list of choices fields.<br />
4. On the specific properties part (right side) of this new list of choices field, write something on the &quot;custom choices&quot; case and click on the &quot;Add&quot; button. Save the field.<br />
5. Remove the under maintenance status<br />
6. Edit an orgunit using that model : select a value in the new list of choice<br />
7. Come back in the orgunit model, and set it again in &quot;Under maintenance&quot;<br />
8. Open the list of choice field and remove a choice in the list of choices<br />
9. Click on Save to close the edit field popup<br />
=&gt; you get an &quot;Unexpected error&quot; with nothing in the log.</td></tr><tr class="print"><td class="print-category">Additional Information</td><td class="print" colspan="5"></td></tr><tr class="print"><td class="print-category">Tags</td><td class="print" colspan="5">No tags attached.</td></tr><tr class="print"><td class="print-category">Relationships</td><td class="print" colspan="5"></td></tr><tr class="print"><td class="print-category">Attached Files</td><td class="print" colspan="5"><img src="images/fileicons/png.gif" alt="png" />&#160;UnderMaintenanceChoiceListCustomChoiceCheckbox_SigmahV2.0.2.PNG (23,458) <span class="italic">2016-11-08 10:46</span><br />http://www.sigmah.org/issues/file_download.php?file_id=354&amp;type=bug<br /><img src="UnderMaintenanceChoiceListCustomChoiceCheckbox_SigmahV2.0.2bbb7.PNG?file_id=354&amp;type=bug" alt="png" border="0" /><br /></td></tr><tr><td class="print-spacer" colspan="6"><hr size="1" /></td></tr><tr><td class="form-title">Issue History</td></tr><tr class="print-category"><td class="row-category-history">Date Modified</td><td class="row-category-history">Username</td><td class="row-category-history">Field</td><td class="row-category-history">Change</td></tr><tr class="print"><td class="print">2016-09-28 10:59</td><td class="print"><a href="view_user_page662f.html?id=104">assisturd</a></td><td class="print">New Issue</td><td class="print"></td></tr><tr class="print"><td class="print">2016-09-28 10:59</td><td class="print"><a href="view_user_page662f.html?id=104">assisturd</a></td><td class="print">Status</td><td class="print">new =&gt; assigned</td></tr><tr class="print"><td class="print">2016-09-28 10:59</td><td class="print"><a href="view_user_page662f.html?id=104">assisturd</a></td><td class="print">Assigned To</td><td class="print"> =&gt; ftavin</td></tr><tr class="print"><td class="print">2016-10-06 14:05</td><td class="print"><a href="view_user_pageb182.html?id=100">ftavin</a></td><td class="print">Note Added: 0002075</td><td class="print"></td></tr><tr class="print"><td class="print">2016-10-24 16:49</td><td class="print"><a href="view_user_page0b30.html?id=2">osarrat</a></td><td class="print">Note Added: 0002181</td><td class="print"></td></tr><tr class="print"><td class="print">2016-10-24 16:49</td><td class="print"><a href="view_user_page0b30.html?id=2">osarrat</a></td><td class="print">Summary</td><td class="print">Non-existant button in orgunits model. =&gt; Impossible to delete custom choice on under maintenance orgunit model</td></tr><tr class="print"><td class="print">2016-10-24 16:49</td><td class="print"><a href="view_user_page0b30.html?id=2">osarrat</a></td><td class="print">Description Updated</td><td class="print">bug_revision_view_page.php?rev_id=935#r935</td></tr><tr class="print"><td class="print">2016-10-24 16:49</td><td class="print"><a href="view_user_page0b30.html?id=2">osarrat</a></td><td class="print">Steps to Reproduce Updated</td><td class="print">bug_revision_view_page.php?rev_id=937#r937</td></tr><tr class="print"><td class="print">2016-11-07 20:35</td><td class="print"><a href="view_user_pageb182.html?id=100">ftavin</a></td><td class="print">Note Added: 0002195</td><td class="print"></td></tr><tr class="print"><td class="print">2016-11-08 10:46</td><td class="print"><a href="view_user_page0b30.html?id=2">osarrat</a></td><td class="print">Note Added: 0002198</td><td class="print"></td></tr><tr class="print"><td class="print">2016-11-08 10:46</td><td class="print"><a href="view_user_page0b30.html?id=2">osarrat</a></td><td class="print">File Added: UnderMaintenanceChoiceListCustomChoiceCheckbox_SigmahV2.0.2.PNG</td><td class="print"></td></tr><tr class="print"><td class="print">2016-11-18 15:09</td><td class="print"><a href="view_user_pageb182.html?id=100">ftavin</a></td><td class="print">Note Added: 0002213</td><td class="print"></td></tr><tr class="print"><td class="print">2016-11-23 15:23</td><td class="print"><a href="view_user_page0b30.html?id=2">osarrat</a></td><td class="print">Note Added: 0002234</td><td class="print"></td></tr><tr class="print"><td class="print">2016-11-23 15:23</td><td class="print"><a href="view_user_page0b30.html?id=2">osarrat</a></td><td class="print">Priority</td><td class="print">normal =&gt; low</td></tr><tr class="print"><td class="print">2016-11-23 15:23</td><td class="print"><a href="view_user_page0b30.html?id=2">osarrat</a></td><td class="print">Product Version</td><td class="print">2.2 =&gt; 2.1</td></tr><tr class="print"><td class="print">2016-11-23 15:23</td><td class="print"><a href="view_user_page0b30.html?id=2">osarrat</a></td><td class="print">Target Version</td><td class="print">2.2 =&gt; next-but-one</td></tr><tr class="print"><td class="print">2016-12-12 11:53</td><td class="print"><a href="view_user_pageb182.html?id=100">ftavin</a></td><td class="print">Assigned To</td><td class="print">ftavin =&gt; </td></tr><tr class="print"><td class="print">2016-12-12 14:17</td><td class="print"><a href="view_user_page0b30.html?id=2">osarrat</a></td><td class="print">Status</td><td class="print">assigned =&gt; new</td></tr><tr class="print"><td class="print">2016-12-14 11:13</td><td class="print"><a href="view_user_page0b30.html?id=2">osarrat</a></td><td class="print">Steps to Reproduce Updated</td><td class="print">bug_revision_view_page.php?rev_id=972#r972</td></tr></table>
<br />
<table class="width100" cellspacing="1">
<tr>
	<td class="form-title" colspan="2">
		Notes	</td>
</tr>
<tr>
	<td class="print-spacer" colspan="2">
		<hr size="1" />
	</td>
</tr>
<tr>
	<td class="nopad" valign="top" width="20%">
		<table class="hide" cellspacing="1">
		<tr>
			<td class="print">
				(0002075)
			</td>
		</tr>
		<tr>
			<td class="print">
				<a href="view_user_pageb182.html?id=100">ftavin</a>&#160;&#160;&#160;
			</td>
		</tr>
		<tr>
			<td class="print">
				2016-10-06 14:05&#160;&#160;&#160;
							</td>
		</tr>
		</table>
	</td>
	<td class="nopad" valign="top" width="85%">
		<table class="hide" cellspacing="1">
		<tr>
			<td class="print">
				Can't reproduce on our demo server.			</td>
		</tr>
		</table>
	</td>
</tr>
<tr>
	<td class="print-spacer" colspan="2">
		<hr size="1" />
	</td>
</tr>
<tr>
	<td class="nopad" valign="top" width="20%">
		<table class="hide" cellspacing="1">
		<tr>
			<td class="print">
				(0002181)
			</td>
		</tr>
		<tr>
			<td class="print">
				<a href="view_user_page0b30.html?id=2">osarrat</a>&#160;&#160;&#160;
			</td>
		</tr>
		<tr>
			<td class="print">
				2016-10-24 16:49&#160;&#160;&#160;
							</td>
		</tr>
		</table>
	</td>
	<td class="nopad" valign="top" width="85%">
		<table class="hide" cellspacing="1">
		<tr>
			<td class="print">
				While reproducing the whole test case app-190, I found out a different bug so I have renamed and reshaped this issue accordingly.<br />
<br />
I have test this &quot;Steps to reproduce&quot; scenario on V2.0.2 available on demo.sigmah.org, and there was there no &quot;Unexpected error&quot;. So this issue seems new to v2.2.			</td>
		</tr>
		</table>
	</td>
</tr>
<tr>
	<td class="print-spacer" colspan="2">
		<hr size="1" />
	</td>
</tr>
<tr>
	<td class="nopad" valign="top" width="20%">
		<table class="hide" cellspacing="1">
		<tr>
			<td class="print">
				(0002195)
			</td>
		</tr>
		<tr>
			<td class="print">
				<a href="view_user_pageb182.html?id=100">ftavin</a>&#160;&#160;&#160;
			</td>
		</tr>
		<tr>
			<td class="print">
				2016-11-07 20:35&#160;&#160;&#160;
							</td>
		</tr>
		</table>
	</td>
	<td class="nopad" valign="top" width="85%">
		<table class="hide" cellspacing="1">
		<tr>
			<td class="print">
				Can't reproduce this issue either on our demo server even following described steps.<br />
<br />
Maybe you should be more specific with the entities used to test (Orgunit model, field, org unit, ...)			</td>
		</tr>
		</table>
	</td>
</tr>
<tr>
	<td class="print-spacer" colspan="2">
		<hr size="1" />
	</td>
</tr>
<tr>
	<td class="nopad" valign="top" width="20%">
		<table class="hide" cellspacing="1">
		<tr>
			<td class="print">
				(0002198)
			</td>
		</tr>
		<tr>
			<td class="print">
				<a href="view_user_page0b30.html?id=2">osarrat</a>&#160;&#160;&#160;
			</td>
		</tr>
		<tr>
			<td class="print">
				2016-11-08 10:46&#160;&#160;&#160;
							</td>
		</tr>
		</table>
	</td>
	<td class="nopad" valign="top" width="85%">
		<table class="hide" cellspacing="1">
		<tr>
			<td class="print">
				Thanks ftavin for this feedback.<br />
Actually, I had reproduced this issue on AtolCD demo server with the model &quot;Copy of Desk v1&quot; from which I had created the orgunit &quot;Antarctica&quot;. The issue had been reproduced on the choice list &quot;Drink choice&quot;.<br />
<br />
And I have tested it again right now on AtolCD demo server with the model &quot;Mission v1&quot;, and I managed to reproduced by removing all the choices and adding one at step 8. When I reproduced the same scenario on v2.0.2 demo.sigmah.org, I didn't get the Unexpected Error.<br />
<br />
An important information: while testing on v2.0.2, I realized that it is not possible to remove custom choices while an orgunit model is under maintenance, but only to disable them. And when you had a new custom choice in a choice list under maintenance, you can actually removed it until you stop the under maintenance status. See new screenshot attached.			</td>
		</tr>
		</table>
	</td>
</tr>
<tr>
	<td class="print-spacer" colspan="2">
		<hr size="1" />
	</td>
</tr>
<tr>
	<td class="nopad" valign="top" width="20%">
		<table class="hide" cellspacing="1">
		<tr>
			<td class="print">
				(0002213)
			</td>
		</tr>
		<tr>
			<td class="print">
				<a href="view_user_pageb182.html?id=100">ftavin</a>&#160;&#160;&#160;
			</td>
		</tr>
		<tr>
			<td class="print">
				2016-11-18 15:09&#160;&#160;&#160;
							</td>
		</tr>
		</table>
	</td>
	<td class="nopad" valign="top" width="85%">
		<table class="hide" cellspacing="1">
		<tr>
			<td class="print">
				I look in the source deeply and find out that this doesn't seems to be a new issue.<br />
<br />
The problem is that if you set the start date/hour of the under maintenance before the creation date of the field you wish to change choices will be considered as deletable (and they shouldn't be).<br />
<br />
You can see the difference with orgunit model Mission v1 and fields Test963 and Test963b. The first one has a creation date anterior to the under maintenance date and you can only enable/disable the choices. The second one has a creation date posterior (a few minutes) to the under maintenance date and you can delete the choices.<br />
<br />
I imagine that in your steps to reproduce, when you set the model under maintenance for the second time you changed the start hour because you didn't want to wait but as the precision is only by 15 minutes the start hour was set before the creation date of the field...<br />
<br />
As a circonstance, this issue should not be assigned to me.<br />
<br />
Hint to resolve : the issue may be linked to the isUpdateAndUnderMaintenance method of the EditFlexibleElementAdminPresenter.			</td>
		</tr>
		</table>
	</td>
</tr>
<tr>
	<td class="print-spacer" colspan="2">
		<hr size="1" />
	</td>
</tr>
<tr>
	<td class="nopad" valign="top" width="20%">
		<table class="hide" cellspacing="1">
		<tr>
			<td class="print">
				(0002234)
			</td>
		</tr>
		<tr>
			<td class="print">
				<a href="view_user_page0b30.html?id=2">osarrat</a>&#160;&#160;&#160;
			</td>
		</tr>
		<tr>
			<td class="print">
				2016-11-23 15:23&#160;&#160;&#160;
							</td>
		</tr>
		</table>
	</td>
	<td class="nopad" valign="top" width="85%">
		<table class="hide" cellspacing="1">
		<tr>
			<td class="print">
				According to ftavin review, this issue is actually not linked to new developments made in v2.2, and is present at least from v2.1.<br />
<br />
After a discussion with ftavin, issue then postponed to &quot;next-but-one&quot; because maintenance mode with start time earlier than now is an artifact situation common while testing the software, but not common in production.			</td>
		</tr>
		</table>
	</td>
</tr>
</table>
</body>

<!-- Mirrored from www.sigmah.org/issues/print_bug_page.php?bug_id=963 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 25 Jul 2018 15:47:59 GMT -->
</html>
